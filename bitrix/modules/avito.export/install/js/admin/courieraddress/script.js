this.BX=this.BX||{},this.BX.AvitoExport=this.BX.AvitoExport||{},function(t){"use strict";var e;const r=null!=(e=window.AvitoJQuery)?e:window.$;class s{constructor(t,e={}){this.$el=r(t),this.el=this.$el[0],this.options=Object.assign({},this.constructor.defaults,this.$el.data(),e)}destroy(){this.el=null}getElement(t,e,r){const s=this.getElementSelector(t);return this.getNode(s,e,r||"find")}getElementSelector(t){const e=t+"Element";return this.options[e]}getTemplate(t){const e=t+"Template",r=this.options[e],s=r.substring(0,1);let i;return i="."===s||"#"===s?this.getNode(r).html():r,i}getNode(t,e,s="find"){return"#"===t.substring(0,1)?e=r(document):e||(e=this.$el),e[s](t)}getLang(t,e){let r,s;return null!=this.options.lang&&t in this.options.lang?s=this.options.lang[t]:(r=this.options.langPrefix+t,s=BX.message(r)||""),s&&e&&(s=function(t,e){let r=t;for(const t in e){if(!e.hasOwnProperty(t))continue;const s="#"+t+"#",i=e[t];do{r=r.replace(s,i)}while(-1!==r.indexOf(s))}return r}(s,e)),s}}var i;s.defaults={lang:{},langPrefix:null};const o=null!=(i=window.AvitoJQuery)?i:window.$;class n extends s{constructor(t,e={}){super(t,e),this.onChange=()=>{const t=this.el.value.trim();""===t?(this.clearError(),this.reset()):(this.clearError(),this.reload(t))},this.bind(),this.boot()}bind(){this.handleChange(!0)}unbind(){this.handleChange(!1)}handleChange(t){this.$el[t?"on":"off"]("change",this.onChange)}boot(){const t=this.$el.val().trim();""===t?this.reset():this.reload(t)}avitoError(t){this.errorElement().text(t.message)}serverError(t){this.errorElement().text(`${t.statusText} ${t.status}`)}clearError(){this.errorElement().text("")}errorElement(){return this.getElement("errorMessage",this.$el,"nextAll")}reload(t){o.ajax({type:"POST",url:this.options.url,dataType:"json",data:{orderId:this.options.orderId,exchangeId:this.options.exchangeId,address:t},success:t=>{if(!0!==(null==t?void 0:t.success))return this.avitoError(t),void this.reset();this.eventAnchor().triggerHandler("avitoCourierTime",{options:t.options})},error:t=>{this.serverError(t),this.reset()}})}reset(){this.eventAnchor().triggerHandler("avitoCourierAddressReset")}eventAnchor(){const t=this.$el.closest("form");return t.length>0?t:o(document)}}n.defaults={url:"/bitrix/tools/avito.export/courieraddress/getcourierdeliveryrange.php",orderId:null,exchangeId:null,errorMessageElement:'[data-entity="error-message"]',lang:{},langPrefix:"AVITO_EXPORT_ADMIN_COURIER_ADDRESS_"},t.CourierAddress=n}(this.BX.AvitoExport.Admin=this.BX.AvitoExport.Admin||{});
//# sourceMappingURL=script.js.map
