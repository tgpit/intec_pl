/*! For license information please see app.js.LICENSE.txt */
!function(){var e={1228:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}},3646:function(e,t,i){var r=i(1228);e.exports=function(e){if(Array.isArray(e))return r(e)}},4575:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},3913:function(e){function t(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}},9713:function(e){e.exports=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},6860:function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},8206:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},319:function(e,t,i){var r=i(3646),n=i(6860),o=i(379),a=i(8206);e.exports=function(e){return r(e)||n(e)||o(e)||a()}},8:function(e){function t(i){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=t=function(e){return typeof e}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(i)}e.exports=t},379:function(e,t,i){var r=i(1228);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(e,t):void 0}}},368:function(){$(document).ready((function(){function e(e,t,i,r){i=i||!1,r=r||!1,e.removeClass("error success preloader  vkapi__market__msg--success vkapi__market__msg--error vkapi__market__msg--preloader").empty().fadeOut(300),r&&e.addClass("preloader vkapi__market__msg--preloader"),null!=t&&0!=t&&(i?e.addClass("error vkapi__market__msg--error").html(t):e.addClass("success vkapi__market__msg--success").html(t))}function t(e,t){if(document.selection)document.selection.createRange().text=t;else if(e.selectionStart||"0"==e.selectionStart){$(e).hasClass("lastfocus")||(e.selectionStart=e.value.length,$(e).focus());var i=e.selectionStart+t.length;e.value=e.value.substring(0,e.selectionStart)+t+e.value.substring(e.selectionEnd,e.value.length),e.selectionStart=i,e.selectionEnd=i}else e.value+=t}$(".ap-vk-auth-box").each((function(){var t=$(this),i=t.find(".msg_box");t.find(".btn_send").on("click",(function(){var r=$(this);r.hasClass("preloader")||(r.addClass("preloader"),$.ajax({type:"POST",dataType:"json",data:{sessid:BX.bitrix_sessid(),method:"auth_standalone_by_code",code:t.find('input[name="code"]').val()},error:function(t){e(i,"Error connection!",!0),r.removeClass("preloader")},success:function(t){t.response?(e(i,t.response.msg),location.reload()):t.error&&e(i,t.error.error_msg,!0),r.removeClass("preloader")}}))}))})),$('form[name="vkapi_market_delete_form"]').each((function(){var t=$(this),i=t.find(".result_box"),r=t.find(".msg_box"),n=t.find('select[name="account"]'),o=t.find(".btn_start"),a=0;function s(t){$.ajax({type:"POST",data:{sessid:BX.bitrix_sessid(),method:"delete",id:n.val(),group:i.find('input[name="group"]:checked').val(),repeate:t||!1},error:function(){o.removeClass("preloader"),e(r,!1,!1),++a<50&&setTimeout((function(){s(!0)}),10)},success:function(t){t.response?t.response.repeat?(e(r,t.response.name,!1,!0),setTimeout((function(){s(!0)}),10)):(e(r,t.response.name),o.removeClass("preloader")):t.error?6==+t.error.code||"ERROR_RESPONSE_STATUS"===t.error.code?(console.log(t.error),setTimeout((function(){s(!0)}),10)):(o.removeClass("preloader"),e(r,t.error.msg,!0)):(o.removeClass("preloader"),e(r,!1,!1))}})}n.on("change",(function(t){var n=$(this);if(t.preventDefault(),t.stopPropagation(),n.hasClass("preloader"))return!1;n.addClass("preloader"),e(r,BX.message("LOADING"),!1,!0),i.hide(),i.find(".account_select_box").empty(),$.ajax({type:"POST",data:{sessid:BX.bitrix_sessid(),method:"account",id:n.val()},error:function(){n.removeClass("preloader"),e(r,!1,!1)},success:function(t){if(t.response)if(n.removeClass("preloader"),e(r,!1,!1),t.response.groups&&t.response.groups.length>0){var o="",a={};for(var s in t.response.groups)o+='<label class="radio_block" for="group_'+(a=t.response.groups[s]).id+'"><input type="radio" name="group" value="'+a.id+'" id="group_'+a.id+'" />'+a.name+"</label>";i.find(".account_select_box").html(o),i.show()}else e(r,BX.message("ACCOUNT_NOT_FOUND"),!0);else t.error?(n.removeClass("preloader"),e(r,t.error.msg,!0)):(n.removeClass("preloader"),e(r,!1,!1))}})})),o.on("click",(function(t){var i=$(this);if(t.preventDefault(),t.stopPropagation(),i.hasClass("preloader"))return!1;i.addClass("preloader"),e(r,BX.message("MARKET_DELETE_START"),!1,!0),s()}))})),$('form[name="vkapi_market_export_form"]').each((function(){var i=$(this),r=(window.VKapiMarketExportEditData,i.find(".msg_box")),n=(i.find(".offer_row_box"),i.find('select[name="SITE_ID"]')),o=i.find('select[name="ACCOUNT_ID"]'),a=(i.find('select[name="CATALOG_ID"]'),i.find(".template_description_area_box")),s=(a.filter(".product_template"),a.filter(".offer_template"),i.find('select[name="PRODUCT_NAME"]'),i.find('select[name="PRODUCT_PHOTO"]'),i.find('select[name="PRODUCT_MORE_PHOTO"]'),i.find('select[name="PRODUCT_PRICE"]'),i.find('select[name="OFFER_NAME"]'),i.find('select[name="OFFER_PHOTO"]'),i.find('select[name="OFFER_MORE_PHOTO"]'),i.find('select[name="OFFER_PRICE"]'),i.find(".group_id_box")),l=s.find('input[name="GROUP_ID"]'),c=s.find('input[name="GROUP_NAME"]'),p=s.find(".result_box");function d(){var e=i.find(".product_main_row"),t=(e.find(".preview_template_box"),e.find(".template_description_area_box .template_description_box span"),e.find('textarea[name="PRODUCT_TEMPLATE"]'),i.find(".offer_main_row")),r=(t.find(".preview_template_box"),t.find(".template_description_area_box .template_description_box span")),n=t.find('textarea[name="OFFER_TEMPLATE_PROLOG"]'),o=t.find('textarea[name="OFFER_TEMPLATE"]'),a=t.find('textarea[name="OFFER_TEMPLATE_EPILOG"]'),s=(t.find('input[name="OFFER_TEMPLATE_TYPE"]:checked').val(),t.find('input[name="OFFER_COMBINE"]:checked').length,{});r.each((function(){s[$(this).attr("data-template")]=$(this).attr("data-prefix")+$(this).text()})),n.val(),o.val(),a.val()}function u(){var t=i.find(".image_box");t.addClass("preloader"),$.ajax({type:"POST",data:{sessid:BX.bitrix_sessid(),method:"getWatermarkPreview",position:i.find("select[name='WATERMARK_POSITION']").val(),opactity:i.find("select[name='WATERMARK_OPACITY']").val(),koef:i.find("select[name='WATERMARK_COEFFICIENT']").val()},error:function(){t.removeClass("preloader")},success:function(i){if(i.response){var n=i.response.src+"?r="+(new Date).getTime()+"."+Math.random();t.removeClass("preloader"),t.parent().find("a").attr("href",n),t.find("img").attr("src",n)}else i.error?(t.removeClass("preloader"),e(r,i.error.msg,!0)):(t.removeClass("preloader"),e(r,!1,!1))}})}i.find(".sections_box"),i.on("change","select[name='WATERMARK_OPACITY']",u),i.on("change","select[name='WATERMARK_COEFFICIENT']",u),i.on("change","select[name='WATERMARK_POSITION']",u),a.on("click",".template_item",(function(e){e.preventDefault(),e.stopPropagation();var i=$(this),r=i.closest(".template_description_area_box"),n=r.find("textarea");r.length&&(r.hasClass("product_template")?t(n.get(0),i.attr("data-template")):n.filter(".lastfocus").length?t(n.filter(".lastfocus").get(0),i.attr("data-template")):t(n.filter('[name="OFFER_TEMPLATE"]').get(0),i.attr("data-template")),d())})),n.on("change",(function(t){var i=$(this);if(t.preventDefault(),t.stopPropagation(),i.hasClass("preloader"))return!1;i.addClass("preloader"),e(r,BX.message("LOADING"),!1,!0),$.ajax({type:"POST",data:{sessid:BX.bitrix_sessid(),method:"getAccountId",site_id:i.val()},error:function(){i.removeClass("preloader"),e(r,!1,!1)},success:function(t){if(t.response){i.removeClass("preloader"),e(r,!1,!1);var n=[];if(t.response.count)for(var a in t.response.items)item=t.response.items[a],n.push('<option value="'+item.id+'">'+item.name+"</option>");else e(r,BX.message("ACCOUNT_NOT_FOUND"),!0);o.html(n.join(""))}else t.error?(i.removeClass("preloader"),e(r,t.error.msg,!0)):(i.removeClass("preloader"),e(r,!1,!1))}})})),o.on("change",(function(t){var i=$(this);if(t.preventDefault(),t.stopPropagation(),i.hasClass("preloader"))return!1;i.addClass("preloader"),e(r,BX.message("LOADING"),!1,!0),p.empty(),$.ajax({type:"POST",data:{sessid:BX.bitrix_sessid(),method:"getGroup",account_id:i.val()},error:function(){i.removeClass("preloader"),e(r,!1,!1)},success:function(t){if(t.response)if(i.removeClass("preloader"),e(r,!1,!1),t.response.count){var n="",o={};for(var a in t.response.items)n+='<label class="radio_block" for="group_'+(o=t.response.items[a]).id+'"><input type="radio" name="group" value="'+o.id+'" id="group_'+o.id+'" />'+o.name+"</label>";p.html(n)}else e(r,BX.message("ACCOUNT_NOT_FOUND"),!0);else t.error?(i.removeClass("preloader"),e(r,t.error.msg,!0)):(i.removeClass("preloader"),e(r,!1,!1))}})})),p.on("change","input",(function(){l.val($(this).attr("value")),c.val($(this).parent().text())})),d(),u()})),$(document).on("click",".js-auto-export-stop-btn",(function(e){e.stopPropagation(),e.preventDefault();var t=$(this),i=t.parent();if(t.hasClass("preloader"))return!1;t.addClass("preloader"),$.ajax({type:"POST",dataType:"json",data:{sessid:BX.bitrix_sessid(),method:"auto_export_stop"},error:function(e){t.removeClass("preloader")},success:function(e){e.response?i.slideUp(300):e.error,t.removeClass("preloader")}})})),$('form[name="vkapi-market-admin-order-sync-edit"]').each((function(){var t=$(this),i=t.find(".vkapi-market-admin-message-block"),r=t.find('select[name="ACCOUNT_ID"]'),n=t.find(".vkapi-market-admin-order-sync-edit__group"),o=n.find('input[name="GROUP_ID"]'),a=n.find('input[name="GROUP_NAME"]'),s=n.find(".vkapi-market-admin-order-sync-edit__group-options");r.on("change",(function(t){var r=$(this);if(t.preventDefault(),t.stopPropagation(),r.hasClass("preloader"))return!1;r.addClass("preloader"),e(i,BX.message("LOADING"),!1,!0),s.empty(),$.ajax({type:"POST",data:{sessid:BX.bitrix_sessid(),method:"getGroup",account_id:r.val()},error:function(){r.removeClass("preloader"),e(i,!1,!1)},success:function(t){if(t.response)if(r.removeClass("preloader"),e(i,!1,!1),t.response.count){var n="",o={};for(var a in t.response.items)n+='<label class="vkapi-market-admin-order-sync-edit__option" for="group_'+(o=t.response.items[a]).id+'"><input type="radio" name="group" value="'+o.id+'" id="group_'+o.id+'" />'+o.name+"</label>";s.html(n)}else e(i,BX.message("ACCOUNT_NOT_FOUND"),!0);else t.error?(r.removeClass("preloader"),e(i,t.error.msg,!0)):(r.removeClass("preloader"),e(i,!1,!1))}})})),s.on("change","input",(function(){o.val($(this).attr("value")),a.val($(this).parent().text())}))})),$(".vkapi-market-admin-option-log-clear").on("click",(function(e){var t=$(this);t.hasClass("vkapi-market-admin-btn--preloader")||(t.addClass("vkapi-market-admin-btn--preloader"),BX.ajax.runAction("vkapi:market.admin.clearLog").then((function(e){alert(e.data.message),t.removeClass("vkapi-market-admin-btn--preloader")})).catch((function(e){e.errors.length&&alert(e.errors[0].message),t.removeClass("vkapi-market-admin-btn--preloader")})))}))}))},4235:function(e,t,i){var r=i(8713);r.component("vkapi-market-condition-catalog-field",{props:{index:{type:String,required:!0},prefix:{type:String,required:!0},type:{type:String,default:""},restore:{}},data:function(){return{}},computed:{localize:function(){return r.getFilteredPhrases("VKAPI_MARKET_CONDITION_")},getInputName:function(){return this.prefix+"["+this.index+"][conditionType]"},getControls:function(){return this.$root.getConditionByType(this.type).controls},controlRestore:function(){var e=this,t={};return this.getControls.forEach((function(i){i.params.name&&(e.restore&&e.restore.values&&e.restore.values.hasOwnProperty(i.params.name)?t[i.params.name]=e.restore.values[i.params.name]:t[i.params.name]=void 0)})),Object.freeze(t)}},methods:{deleteCurrent:function(){this.$emit("delete",{type:this.type,index:this.index})},copyCurrent:function(){this.$emit("copy",{type:this.type,index:this.index})}},render:function(e){var t=this,i=this,r=[];r.push(e("input",{attrs:{type:"hidden",name:i.getInputName,value:i.type}})),r.push(e("div",{class:"vkapi-market-condition__delete",attrs:{title:i.localize.VKAPI_MARKET_CONDITION_ITEM_DELETE},on:{click:i.deleteCurrent}})),r.push(e("div",{class:"vkapi-market-condition__copy",attrs:{title:i.localize.VKAPI_MARKET_CONDITION_ITEM_COPY},on:{click:i.copyCurrent}},i.localize.VKAPI_MARKET_CONDITION_ITEM_COPY));var n=[];return i.getControls.forEach((function(r){n.push(e(r.component,{props:{prefix:i.prefix,index:i.index,params:r.params,restore:r.params.name&&i.controlRestore[r.params.name]?i.controlRestore[r.params.name]:void 0,restoreValues:t.restore&&t.restore.values?t.restore.values:void 0}}))})),n.length&&r.push(e("div",{class:"vkapi-market-condition__controls"},n)),e("div",{class:"vkapi-market-condition__wrapper vkapi-market-condition__wrapper--catalog-field",attrs:{"data-id":i.type,"data-index":i.index}},[e("div",{class:"vkapi-market-condition__container vkapi-market-condition__container--simple"},r)])}})},7707:function(e,t,i){i(8713).component("vkapi-market-condition-control-calendar",{props:{prefix:{type:String,required:!0},index:{type:String,required:!0},params:{type:Object,required:!0,validator:function(e){return!!e.name}},restore:{}},data:function(){var e={};if(e={bShowField:!1,name:this.params.name||"",value:this.params.value||"",label:this.params.label||"...",showTime:this.params.showTime||!1,format:BX.message(this.params.showTime?"FORMAT_DATETIME":"FORMAT_DATE"),valuePreview:""},this.restore){var t=new Date;e.value=this.restore,e.value>0&&(t.setTime(1e3*e.value),e.valuePreview=BX.calendar.ValueToStringFormat(t,e.format,!1))}return e},created:function(){this.$root.$on("setControlValue",this.setValueListener)},beforeDestroy:function(){this.$root.$off("setControlValue",this.setValueListener)},computed:{getBtnLabel:function(){return this.valuePreview||this.label},getInputName:function(){return this.prefix+"["+this.index+"]["+this.name+"]"}},methods:{showInput:function(){var e=this;this.bShowField=!0;var t=this.value.length;if(this.$refs.input.setSelectionRange)this.$refs.input.setSelectionRange(t,t);else if(this.$refs.input.createTextRange){var i=this.$refs.input.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}this.$nextTick((function(){return e.$refs.input.focus()}))},showCalendar:function(){var e=this;BX.calendar({node:this.$refs.input,field:this.$refs.input,bTime:e.showTime,bHideTime:!e.showTime,callback_after:function(t){var i=new Date(t);e.value=i.getTime()/1e3,e.valuePreview=BX.calendar.ValueToStringFormat(i,e.format,!1),e.bShowField=!1}})},setValueListener:function(e){e.prefix==this.prefix&&e.index==this.index&&e.name==this.name&&(this.value=e.value)}},template:'            \n                <div class="vkapi-market-condition-control vkapi-market-condition-control--calendar" >                   \n                    <div class="vkapi-market-condition-control__label vkapi-market-condition-link vkapi-market-condition-link--line" v-show="!bShowField" @click="showInput">{{getBtnLabel}}</div>\n                    <div class="vkapi-market-condition-control__value" v-show="bShowField" >\n                        <input type="hidden" :name="getInputName" :value="value" />\n                        <input ref="input" v-model="valuePreview"  />\n                        <div ref="icon" class="vkapi-market-condition-control__icon" @click="showCalendar"></div>\n                    </div>\n                </div>\n            '})},3004:function(e,t,i){i(8713).component("vkapi-market-condition-control-iblockelementfind",{props:{prefix:{type:String,required:!0},index:{type:String,required:!0},params:{type:Object,required:!0,validator:function(e){return!!e.name}},restore:{},restoreValues:{}},data:function(){var e={};return e={bShowField:!1,name:this.params.name||"",value:this.params.value||"",label:this.params.label||"..."},this.restore&&(e.value=this.restore),this.params.name&&this.restoreValues&&this.restoreValues[this.params.name+"Preview"]&&(e.label=this.restoreValues[this.params.name+"Preview"]),e},created:function(){this.$root.$on("setControlValue",this.setValueListener)},beforeDestroy:function(){this.$root.$off("setControlValue",this.setValueListener)},computed:{getBtnLabel:function(){return this.label},getInputName:function(){return this.prefix+"["+this.index+"]["+this.name+"]"}},methods:{selectedValue:function(e,t){$(window).off("VKapiMarketConditionIblockElementSelectedValue",this.selectedValue),t&&t.title&&(this.params.searchXmlId?(this.value=t.xmlId,this.label=t.xmlTitle):(this.value=t.id,this.label=t.title))},startLookFor:function(){var e=[];e.push("IBLOCK_ID="+this.params.iblockId),this.params.iblockId&&e.push("iblockfix=y"),window.open("/bitrix/admin/vkapi.market_iblock_element_search.php?"+e.join("&"),"","menubar=no,location=yes,resizable=yes,scrollbars=yes,status=no"),$(window).on("VKapiMarketConditionIblockElementSelectedValue",this.selectedValue)},setValueListener:function(e){e.prefix==this.prefix&&e.index==this.index&&e.name==this.name&&(this.value=e.value,e.label&&(this.label=e.label))}},template:'            \n                <div class="vkapi-market-condition-control vkapi-market-condition-control--iblockelementfind" >                   \n                    <div class="vkapi-market-condition-control__label vkapi-market-condition-link vkapi-market-condition-link--line"  @click.stop.prevent="startLookFor">{{getBtnLabel}}</div>\n                    <input type="hidden"  :name="getInputName" v-model="value" />\n                </div>\n            '})},8057:function(e,t,i){i(8713).component("vkapi-market-condition-control-iblocksectionfind",{props:{prefix:{type:String,required:!0},index:{type:String,required:!0},params:{type:Object,required:!0,validator:function(e){return!!e.name}},restore:{},restoreValues:{}},data:function(){var e={};return e={bShowField:!1,name:this.params.name||"",value:this.params.value||"",label:this.params.label||"..."},this.restore&&(e.value=this.restore),this.params.name&&this.restoreValues&&this.restoreValues[this.params.name+"Preview"]&&(e.label=this.restoreValues[this.params.name+"Preview"]),e},created:function(){this.$root.$on("setControlValue",this.setValueListener)},beforeDestroy:function(){this.$root.$off("setControlValue",this.setValueListener)},computed:{getBtnLabel:function(){return this.label},getInputName:function(){return this.prefix+"["+this.index+"]["+this.name+"]"}},methods:{selectedValue:function(e,t){$(window).off("VKapiMarketConditionIblockSectionSelectedValue",this.selectedValue),t&&t.title&&(this.value=t.id,this.label=t.title)},startLookFor:function(){var e=[];e.push("IBLOCK_ID="+this.params.iblockId),this.params.iblockId&&e.push("iblockfix=y"),window.open("/bitrix/admin/vkapi.market_iblock_section_search.php?"+e.join("&"),"","menubar=no,location=yes,resizable=yes,scrollbars=yes,status=no"),$(window).on("VKapiMarketConditionIblockSectionSelectedValue",this.selectedValue)},setValueListener:function(e){e.prefix==this.prefix&&e.index==this.index&&e.name==this.name&&(this.value=e.value,e.label&&(this.label=e.label))}},template:'            \n                <div class="vkapi-market-condition-control vkapi-market-condition-control--iblocksectionfind" >                   \n                    <div class="vkapi-market-condition-control__label vkapi-market-condition-link vkapi-market-condition-link--line"  @click.stop.prevent="startLookFor">{{getBtnLabel}}</div>\n                    <input type="hidden"  :name="getInputName" v-model="value" />\n                </div>\n            '})},9718:function(e,t,i){i(8713).component("vkapi-market-condition-control-input",{props:{prefix:{type:String,required:!0},index:{type:String,required:!0},params:{type:Object,required:!0,validator:function(e){return!!e.name}},restore:{}},data:function(){var e={};return e={bShowField:!1,name:this.params.name||"",value:this.params.value||"",label:this.params.label||"..."},this.restore&&(e.value=this.restore),e},created:function(){this.$root.$on("setControlValue",this.setValueListener)},beforeDestroy:function(){this.$root.$off("setControlValue",this.setValueListener)},computed:{getBtnLabel:function(){return this.value||this.label},getInputName:function(){return this.prefix+"["+this.index+"]["+this.name+"]"}},methods:{setInputFocus:function(){var e=this;this.bShowField=!0;var t=this.value.length;if(this.$refs.input.setSelectionRange)this.$refs.input.setSelectionRange(t,t);else if(this.$refs.input.createTextRange){var i=this.$refs.input.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}this.$root.$emit("setActiveExternalControl"),this.$nextTick((function(){return e.$refs.input.focus()}))},setValueListener:function(e){e.prefix==this.prefix&&e.index==this.index&&e.name==this.name&&(this.value=e.value)}},template:'            \n                <div class="vkapi-market-condition-control vkapi-market-condition-control--input" >                   \n                    <div class="vkapi-market-condition-control__label vkapi-market-condition-link vkapi-market-condition-link--line" v-show="!bShowField" @click.stop.prevent="setInputFocus">{{getBtnLabel}}</div>\n                    <div class="vkapi-market-condition-control__value" v-show="bShowField" >\n                        <input ref="input" :name="getInputName" v-model="value" @blur="bShowField=false"  />\n                    </div>\n                </div>\n            '})},7581:function(e,t,i){i(8713).component("vkapi-market-condition-control-prefix",{props:{params:{type:Object,required:!0,validator:function(e){return!!e.text}}},data:function(){return{text:this.params.text||""}},template:'<div class="vkapi-market-condition-control vkapi-market-condition-control--prefix" v-html="text"></div>'})},5099:function(e,t,i){var r=i(8713);r.component("vkapi-market-condition-control-select",{props:{prefix:{type:String,required:!0},index:{type:String,required:!0},params:{type:Object,required:!0,validator:function(e){return!!e.values}},restore:{},restoreValues:{}},data:function(){var e={isShowPreloader:!1,isShowSelect:!1,enabledSearch:this.params.enabledSearch||!1,firstEmpty:this.params.firstEmpty||"",save:0!=this.params.save,search:"",name:this.params.name?this.params.name:"",values:this.params.values?this.params.values:[],value:this.params.value?this.params.value:"",label:this.params.label?this.params.label:"...",ajaxValuesUrl:!!this.params.ajaxValuesUrl&&this.params.ajaxValuesUrl};return this.restore&&(e.value=this.restore),this.params.name&&this.restoreValues&&this.restoreValues[this.params.name+"Preview"]&&(e.label=this.restoreValues[this.params.name+"Preview"]),e},created:function(){this.$root.$on("setControlValue",this.setValueListener),this.$root.$on("setActiveExternalControl",this.hideSelect)},beforeDestroy:function(){this.$root.$off("setControlValue",this.setValueListener),this.$root.$off("setActiveExternalControl",this.hideSelect)},mounted:function(){},computed:{localize:function(){return r.getFilteredPhrases("VKAPI_MARKET_CONDITION_CONTROL_SELECT_")},getBtnLabel:function(){var e=this;if(this.save||this.value){var t=this.values.find((function(t){return t.id==e.value}));if(t&&t.name)return t.name}return this.params.firstEmpty?this.params.firstEmpty:this.label},getInputName:function(){return this.prefix+"["+this.index+"]["+this.name+"]"},getItems:function(){var e=this.search.toString().toLowerCase();return this.values.filter((function(t){return!!t.name&&!!~t.name.toLowerCase().indexOf(e)}))},getNoGroupItems:function(){var e=[];return this.getItems.forEach((function(t){t.group||e.push(t)})),e},getGroupItems:function(){var e={};return this.getItems.forEach((function(t){t.group&&(e[t.group]||(e[t.group]={name:t.group,items:[]}),e[t.group].items.push(t))})),Object.values(e)}},methods:{loadSelectValues:function(){var e=this;if(this.ajaxValuesUrl){var t=this.ajaxValuesUrl;t+=(~t.toString().indexOf("?")?"&":"?").toString().concat("sessid="+BX.bitrix_sessid()),this.ajaxValuesUrl=!1,e.isShowPreloader=!0,$.ajax({url:t,type:"POST",data:{},dataType:"json",error:function(){e.isShowPreloader=!1,e.showSelect()},success:function(t){e.isShowPreloader=!1,t.response.items&&(e.values=t.response.items),e.showSelect()}})}else e.showSelect()},showSelect:function(){if(this.isShowSelect)return!1;$(window.document).on("click",this.hideSelect),this.$root.$emit("setActiveExternalControl"),this.isShowSelect=!0;var e=$(this.$refs.selectLabel),t=e.offset();$(this.$refs.selectContent).parent().is("body")||$(this.$refs.selectContent).appendTo("body"),$(this.$refs.selectContent).css({display:"inline-block",left:t.left,top:t.top+e.height()+2})},hideSelect:function(){this.isShowSelect&&($(window.document).off("click",this.hideSelect),this.isShowSelect=!1)},setValueListener:function(e){e.prefix==this.prefix&&e.index==this.index&&e.name==this.name&&(this.value=e.value,this.$emit("change",{name:this.name,value:this.value}))},selectItem:function(e){-1==e&&(e=""),this.save&&(this.value=e),this.hideSelect(),this.$nextTick((function(){e&&this.$emit("change",{name:this.name,value:e})}))}},template:'            \n                <div class="vkapi-market-condition-control vkapi-market-condition-control--select" @click.prevent.stop >           \n                    <input type="hidden" :name="getInputName" :value="value" >\n                        \n                    <div class="vkapi-market-condition-control-select"  :class="{\'vkapi-market-condition-control-select--preloader\' : isShowPreloader}">                    \n                        <div class="vkapi-market-condition-control-select__label" ref="selectLabel">\n                            <div class="vkapi-market-condition-control__label vkapi-market-condition-link vkapi-market-condition-link--line" @click.prevent.stop="loadSelectValues"  >{{getBtnLabel}}</div>\n                        </div>\n                        \n                        <div class="vkapi-market-condition-control-select__content" v-show="isShowSelect"  ref="selectContent" @click.prevent.stop :key="getInputName">\n                            <div class="vkapi-market-condition-control-select-search" v-if="enabledSearch">\n                                <input type="text" v-model="search" :placeholder="localize.VKAPI_MARKET_CONDITION_CONTROL_SELECT_SEARCH" />\n                                <div class="vkapi-market-condition-control-select-search__close" @click="search=\'\'" v-show="search"></div>\n                            </div>\n                                                        \n                            <div class="vkapi-market-condition-control-select__list">\n                                <div class="vkapi-market-condition-control-select__list-scroller scrollbar-outer" ref="list">\n                                    <div class="vkapi-market-condition-control-select-item" v-if="firstEmpty && !search" :key="-1" @click.prevent.stop="selectItem(-1)">\n                                        <div class="vkapi-market-condition-control-select-item__name">{{firstEmpty}}</div>\n                                    </div>                                          \n                                    <div class="vkapi-market-condition-control-select-item" v-for="item in getNoGroupItems" :key="item.id" @click.prevent.stop="selectItem(item.id)">\n                                        <div class="vkapi-market-condition-control-select-item__name">{{item.name}}</div>\n                                    </div> \n                                                                                              \n                                    <div class="vkapi-market-condition-control-select-group" v-for="group in getGroupItems">\n                                        <div class="vkapi-market-condition-control-select-group__label">{{group.name}}</div>\n                                        <div class="vkapi-market-condition-control-select-group__list">\n                                            <div class="vkapi-market-condition-control-select-item" v-for="item in group.items" :key="item.id" @click.prevent.stop="selectItem(item.id)">\n                                                <div class="vkapi-market-condition-control-select-item__name">{{item.name}}</div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                                                    \n                                    <div class="vkapi-market-condition-control-select-item vkapi-market-condition-control-select-item--empty" v-if="!getItems.length">{{localize.VKAPI_MARKET_CONDITION_CONTROL_SELECT_LIST_EMPTY}}</div>\n                                </div>\n                            </div>\n                        </div>                        \n                    </div> \n                </div>\n            '})},3933:function(e,t,i){i(8713).component("vkapi-market-condition-control-text",{props:{params:{type:Object,required:!0,validator:function(e){return!!e.text}}},data:function(){return{text:this.params.text||""}},template:'<div class="vkapi-market-condition-control vkapi-market-condition-control--text" v-html="text"></div>'})},293:function(e,t,i){var r=i(8713);r.component("vkapi-market-condition-group",{props:{index:{type:String,required:!0},prefix:{type:String,required:!0},type:{type:String,default:""},root:{type:Boolean,default:!1},restore:{}},data:function(){var e=this,t={counter:0,items:[],controlValues:{}};return this.$root.getConditionByType(this.type).controls.forEach((function(i){i.params.name&&(e.restore&&e.restore.values&&i.params.name in e.restore.values?t.controlValues[i.params.name]=e.restore.values[i.params.name]:i.params.value&&(t.controlValues[i.params.name]=i.params.value))})),this.restore&&this.restore.values&&this.restore.childs.forEach((function(i){var r=e.$root.getConditionByType(i.type+":"+i.id);r&&t.items.push({type:i.type+":"+i.id,component:r.component,index:e.index+"__"+t.counter++,restore:i})})),t},computed:{localize:function(){return r.getFilteredPhrases("VKAPI_MARKET_CONDITION_")},getWrapperBlockClasses:function(){return"vkapi-market-condition__wrapper vkapi-market-condition__wrapper--group "},getInputName:function(){return this.prefix+"["+this.index+"][conditionType]"},getControls:function(){return this.$root.getConditionByType(this.type).controls},controlRestore:function(){var e=this,t={};return this.getControls.forEach((function(i){i.params.name&&(e.restore&&e.restore.values&&e.restore.values.hasOwnProperty(i.params.name)?t[i.params.name]=e.restore.values[i.params.name]:t[i.params.name]=void 0)})),Object.freeze(t)},getConditionViewParams:function(){var e=this,t=this.$root.getConditionByType(this.type),i=t.more.visual.find((function(t){for(var i in t.rule)if(t.rule[i]!=e.controlValues[i])return!1;return!0}));return void 0===i&&t.more.visual.length&&(i=t.more.visual[0]),i}},methods:{addConditionItem:function(e){var t=this.$root.getConditionByType(e);this.items.push({type:e,component:t.component,index:this.index+"__"+this.counter++})},deleteCurrent:function(){this.$emit("delete",{type:this.type,index:this.index})},copyCurrent:function(){this.$emit("copy",{type:this.type,index:this.index})},deleteChild:function(e){var t=this.items.findIndex((function(t){return t.index==e.index}));~t&&this.items.splice(t,1)},copyChild:function(e){this.addConditionItem(e.type)},changeControlValue:function(e){this.controlValues[e.name]=e.value},selectConditionForAdd:function(e){this.addConditionItem(e.value)},changeControlVisual:function(){var e=this,t=this.$root.getConditionByType(this.type),i=t.more.visual.findIndex((function(t){for(var i in t.rule)if(t.rule[i]!=e.controlValues[i])return!1;return!0}));if(!~i)return!1;i++,t.more.visual[i]||(i=0);var r=t.more.visual[i];for(var n in r.rule)this.controlValues[n]!=r.rule[n]&&this.$root.$emit("setControlValue",{prefix:this.prefix,index:this.index,name:n,value:r.rule[n]})}},render:function(e){var t=this,i=this,r=[];r.push(e("input",{attrs:{type:"hidden",name:i.getInputName,value:i.type}}));var n=[];i.getControls.forEach((function(r){n.push(e(r.component,{props:{prefix:i.prefix,index:i.index,params:r.params,restore:r.params.name&&i.controlRestore[r.params.name]?i.controlRestore[r.params.name]:void 0},on:{change:t.changeControlValue}}))})),n.length&&r.push(e("div",{class:"vkapi-market-condition__controls"},n)),i.root||(r.push(e("div",{class:"vkapi-market-condition__delete",attrs:{title:i.localize.VKAPI_MARKET_CONDITION_ITEM_DELETE},on:{click:i.deleteCurrent}})),r.push(e("div",{class:"vkapi-market-condition__copy",attrs:{title:i.localize.VKAPI_MARKET_CONDITION_ITEM_COPY},on:{click:i.copyCurrent}},i.localize.VKAPI_MARKET_CONDITION_ITEM_COPY)));var o=[];return i.items.forEach((function(r,n,a){o.push(e(r.component,{key:i.prefix+"_"+r.index,props:{prefix:i.prefix,index:r.index,type:r.type,restore:r.hasOwnProperty("restore")?r.restore:void 0},on:{delete:i.deleteChild,copy:i.copyChild}})),n+1<a.length&&o.push(e("div",{class:["vkapi-market-condition-logic",t.getConditionViewParams.class]},[e("span",{on:{click:t.changeControlVisual}},t.getConditionViewParams.text)]))})),o.length&&r.push(e("div",{class:"vkapi-market-condition__items"},o)),r.push(e("div",{class:"vkapi-market-condition__action"},[e("vkapi-market-condition-control-select",{props:{prefix:i.prefix,index:i.index,params:{name:"add_condition",save:!1,values:i.$root.getAllConditionForSelect,label:i.localize.VKAPI_MARKET_CONDITION_ITEM_ADD,enabledSearch:!0}},on:{change:i.selectConditionForAdd}})])),e("div",{class:"vkapi-market-condition__wrapper vkapi-market-condition__wrapper--group",attrs:{"data-id":i.type,"data-index":i.index}},[e("div",{class:"vkapi-market-condition__container vkapi-market-condition__container--group"},r)])}})},1545:function(e,t,i){var r=i(8713);r.component("vkapi-market-condition-iblock-element-field-base",{props:{index:{type:String,required:!0},prefix:{type:String,required:!0},type:{type:String,default:""},restore:{}},data:function(){return{}},computed:{localize:function(){return r.getFilteredPhrases("VKAPI_MARKET_CONDITION_")},getInputName:function(){return this.prefix+"["+this.index+"][conditionType]"},getControls:function(){return this.$root.getConditionByType(this.type).controls},controlRestore:function(){var e=this,t={};return this.getControls.forEach((function(i){i.params.name&&(e.restore&&e.restore.values&&e.restore.values.hasOwnProperty(i.params.name)?t[i.params.name]=e.restore.values[i.params.name]:t[i.params.name]=void 0)})),Object.freeze(t)}},methods:{deleteCurrent:function(){this.$emit("delete",{type:this.type,index:this.index})},copyCurrent:function(){this.$emit("copy",{type:this.type,index:this.index})}},render:function(e){var t=this,i=this,r=[];r.push(e("input",{attrs:{type:"hidden",name:i.getInputName,value:i.type}})),r.push(e("div",{class:"vkapi-market-condition__delete",attrs:{title:i.localize.VKAPI_MARKET_CONDITION_ITEM_DELETE},on:{click:i.deleteCurrent}})),r.push(e("div",{class:"vkapi-market-condition__copy",attrs:{title:i.localize.VKAPI_MARKET_CONDITION_ITEM_COPY},on:{click:i.copyCurrent}},i.localize.VKAPI_MARKET_CONDITION_ITEM_COPY));var n=[];return i.getControls.forEach((function(r){n.push(e(r.component,{props:{prefix:i.prefix,index:i.index,params:r.params,restore:r.params.name&&i.controlRestore[r.params.name]?i.controlRestore[r.params.name]:void 0,restoreValues:t.restore&&t.restore.values?t.restore.values:void 0}}))})),n.length&&r.push(e("div",{class:"vkapi-market-condition__controls"},n)),e("div",{class:"vkapi-market-condition__wrapper vkapi-market-condition__wrapper--iblock-element-field",attrs:{"data-id":i.type,"data-index":i.index}},[e("div",{class:"vkapi-market-condition__container vkapi-market-condition__container--simple"},r)])}})},4391:function(e,t,i){var r=i(8713);r.component("vkapi-market-condition-iblock-element-field",{props:{index:{type:String,required:!0},prefix:{type:String,required:!0},type:{type:String,default:""},restore:{}},data:function(){return{}},computed:{localize:function(){return r.getFilteredPhrases("VKAPI_MARKET_CONDITION_")},getInputName:function(){return this.prefix+"["+this.index+"][conditionType]"},getControls:function(){return this.$root.getConditionByType(this.type).controls},controlRestore:function(){var e=this,t={};return this.getControls.forEach((function(i){i.params.name&&(e.restore&&e.restore.values&&e.restore.values.hasOwnProperty(i.params.name)?t[i.params.name]=e.restore.values[i.params.name]:t[i.params.name]=void 0)})),Object.freeze(t)}},methods:{deleteCurrent:function(){this.$emit("delete",{type:this.type,index:this.index})},copyCurrent:function(){this.$emit("copy",{type:this.type,index:this.index})}},render:function(e){var t=this,i=this,r=[];r.push(e("input",{attrs:{type:"hidden",name:i.getInputName,value:i.type}})),r.push(e("div",{class:"vkapi-market-condition__delete",attrs:{title:i.localize.VKAPI_MARKET_CONDITION_ITEM_DELETE},on:{click:i.deleteCurrent}})),r.push(e("div",{class:"vkapi-market-condition__copy",attrs:{title:i.localize.VKAPI_MARKET_CONDITION_ITEM_COPY},on:{click:i.copyCurrent}},i.localize.VKAPI_MARKET_CONDITION_ITEM_COPY));var n=[];return i.getControls.forEach((function(r){n.push(e(r.component,{props:{prefix:i.prefix,index:i.index,params:r.params,restore:r.params.name&&i.controlRestore[r.params.name]?i.controlRestore[r.params.name]:void 0,restoreValues:t.restore&&t.restore.values?t.restore.values:void 0}}))})),n.length&&r.push(e("div",{class:"vkapi-market-condition__controls"},n)),e("div",{class:"vkapi-market-condition__wrapper vkapi-market-condition__wrapper--iblock-element-field",attrs:{"data-id":i.type,"data-index":i.index}},[e("div",{class:"vkapi-market-condition__container vkapi-market-condition__container--simple"},r)])}})},7228:function(e,t,i){var r=i(8713);r.component("vkapi-market-condition-iblock-element-property",{props:{index:{type:String,required:!0},prefix:{type:String,required:!0},type:{type:String,default:""},restore:{}},data:function(){return{}},computed:{localize:function(){return r.getFilteredPhrases("VKAPI_MARKET_CONDITION_")},getInputName:function(){return this.prefix+"["+this.index+"][conditionType]"},getControls:function(){return this.$root.getConditionByType(this.type).controls},controlRestore:function(){var e=this,t={};return this.getControls.forEach((function(i){i.params.name&&(e.restore&&e.restore.values&&e.restore.values.hasOwnProperty(i.params.name)?t[i.params.name]=e.restore.values[i.params.name]:t[i.params.name]=void 0)})),Object.freeze(t)}},methods:{deleteCurrent:function(){this.$emit("delete",{type:this.type,index:this.index})},copyCurrent:function(){this.$emit("copy",{type:this.type,index:this.index})}},render:function(e){var t=this,i=this,r=[];r.push(e("input",{attrs:{type:"hidden",name:i.getInputName,value:i.type}})),r.push(e("div",{class:"vkapi-market-condition__delete",attrs:{title:i.localize.VKAPI_MARKET_CONDITION_ITEM_DELETE},on:{click:i.deleteCurrent}})),r.push(e("div",{class:"vkapi-market-condition__copy",attrs:{title:i.localize.VKAPI_MARKET_CONDITION_ITEM_COPY},on:{click:i.copyCurrent}},i.localize.VKAPI_MARKET_CONDITION_ITEM_COPY));var n=[];return i.getControls.forEach((function(r){n.push(e(r.component,{props:{prefix:i.prefix,index:i.index,params:r.params,restore:r.params.name&&i.controlRestore[r.params.name]?i.controlRestore[r.params.name]:void 0,restoreValues:t.restore&&t.restore.values?t.restore.values:void 0}}))})),n.length&&r.push(e("div",{class:"vkapi-market-condition__controls"},n)),e("div",{class:"vkapi-market-condition__wrapper vkapi-market-condition__wrapper--iblock-element-property",attrs:{"data-id":i.type,"data-index":i.index}},[e("div",{class:"vkapi-market-condition__container vkapi-market-condition__container--simple"},r)])}})},7210:function(e,t,i){i(8713).component("vkapi-market-admin-message",{props:["message","error"],template:'\n            <div class="vkapi-market-admin-message" v-bind:class="{\'vkapi-market-admin-message--success\' : !error, \'vkapi-market-admin-message--error\' : error}" v-if="message" v-html="message"></div>\n            '})},1422:function(e,t,i){i(8713).component("vkapi-market-admin-message",{props:["message","error"],template:'\n            <div class="vkapi-market-admin-message" v-bind:class="{\'vkapi-market-admin-message--success\' : !error, \'vkapi-market-admin-message--error\' : error}" v-if="message" v-html="message"></div>\n            '})},2240:function(e,t,i){var r=i(8713);r.component("vkapi-market-select-with-img",{props:{items:Array},data:function(){return{search:"",bShowList:!1}},mounted:function(){},computed:{localize:function(){return r.getFilteredPhrases("VKAPI_MARKET_SELECT_WITH_IMG_")},getItems:function(){var e=this;return this.items.filter((function(t){return!!~t.name.toLowerCase().indexOf(e.search.toLowerCase())}))}},methods:{selectItem:function(e){this.bShowList=!1,this.$emit("selectItem",{id:e})},showSelect:function(){if(this.bShowList)return!1;$(window.document).on("click",this.hideSelect),this.bShowList=!0,$(window.document).on("click",this.hideSelect)},hideSelect:function(){this.bShowList&&(this.bShowList=!1,$(window.document).off("click",this.hideSelect))}},template:'\n                <div class="vkapi-market-select-with-img" @blur="console.log(\'*\')" >\n                    <div class="vkapi-market-select-with-img__btn vkapi-market-admin-btn vkapi-market-admin-btn--button vkapi-market-admin-btn--success" v-show="!bShowList" @click.prevent.stop="showSelect">{{localize.VKAPI_MARKET_SELECT_WITH_IMG_BTN}}</div>\n                    <div class="vkapi-market-select-with-img__container" v-show="bShowList">\n                        <div class="vkapi-market-select-with-img__search" @click.prevent.stop>\n                            <input type="text" v-model="search" :placeholder="localize.VKAPI_MARKET_SELECT_WITH_IMG_SEARCH_PH" />\n                        </div>\n                        <div class="vkapi-market-select-with-img__items scrollbar-outer" ref="list">\n                            <div class="vkapi-market-select-with-img-item" v-for="item in getItems" :key="item.id" @click.prevent.stop="selectItem(item.id)">\n                                <div class="vkapi-market-select-with-img-item__img">\n                                    <img v-if="item.img" :src="item.img" >\n                                </div>\n                                <div class="vkapi-market-select-with-img-item__name">{{item.name}}</div>\n                            </div>\n                            <div class="vkapi-market-select-with-img-item vkapi-market-select-with-img-item--empty" v-if="!getItems.length">{{localize.VKAPI_MARKET_SELECT_WITH_IMG_EMPTY}}</div>\n                        </div>\n                    </div>\n                </div>\n            '})},334:function(){!function(e){"use strict";var t={data:{index:0,name:"scrollbar"},macosx:/mac/i.test(navigator.platform),mobile:/android|webos|iphone|ipad|ipod|blackberry/i.test(navigator.userAgent),overlay:null,scroll:null,scrolls:[],webkit:/webkit/i.test(navigator.userAgent)&&!/edge\/\d+/i.test(navigator.userAgent)};t.scrolls.add=function(e){this.remove(e).push(e)},t.scrolls.remove=function(t){for(;e.inArray(t,this)>=0;)this.splice(e.inArray(t,this),1);return this};var i={autoScrollSize:!0,autoUpdate:!0,debug:!1,disableBodyScroll:!1,duration:200,ignoreMobile:!1,ignoreOverlay:!1,scrollStep:30,showArrows:!1,stepScrolling:!0,scrollx:null,scrolly:null,onDestroy:null,onInit:null,onScroll:null,onUpdate:null},r=function(r){var n;t.scroll||(t.overlay=!((n=s(!0)).height||n.width),t.scroll=s(),a(),e(window).resize((function(){var e=!1;if(t.scroll&&(t.scroll.height||t.scroll.width)){var i=s();i.height===t.scroll.height&&i.width===t.scroll.width||(t.scroll=i,e=!0)}a(e)}))),this.container=r,this.namespace=".scrollbar_"+t.data.index++,this.options=e.extend({},i,window.jQueryScrollbarOptions||{}),this.scrollTo=null,this.scrollx={},this.scrolly={},r.data(t.data.name,this),t.scrolls.add(this)};r.prototype={destroy:function(){if(this.wrapper){this.container.removeData(t.data.name),t.scrolls.remove(this);var i=this.container.scrollLeft(),r=this.container.scrollTop();this.container.insertBefore(this.wrapper).css({height:"",margin:"","max-height":""}).removeClass("scroll-content scroll-scrollx_visible scroll-scrolly_visible").off(this.namespace).scrollLeft(i).scrollTop(r),this.scrollx.scroll.removeClass("scroll-scrollx_visible").find("div").andSelf().off(this.namespace),this.scrolly.scroll.removeClass("scroll-scrolly_visible").find("div").andSelf().off(this.namespace),this.wrapper.remove(),e(document).add("body").off(this.namespace),e.isFunction(this.options.onDestroy)&&this.options.onDestroy.apply(this,[this.container])}},init:function(i){var r=this,n=this.container,o=this.containerWrapper||n,a=this.namespace,s=e.extend(this.options,i||{}),c={x:this.scrollx,y:this.scrolly},p=this.wrapper,d={scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop()};if(t.mobile&&s.ignoreMobile||t.overlay&&s.ignoreOverlay||t.macosx&&!t.webkit)return!1;if(p)o.css({height:"auto","margin-bottom":-1*t.scroll.height+"px","margin-right":-1*t.scroll.width+"px","max-height":""});else{if(this.wrapper=p=e("<div>").addClass("scroll-wrapper").addClass(n.attr("class")).css("position","absolute"==n.css("position")?"absolute":"relative").insertBefore(n).append(n),n.is("textarea")&&(this.containerWrapper=o=e("<div>").insertBefore(n).append(n),p.addClass("scroll-textarea")),o.addClass("scroll-content").css({height:"auto","margin-bottom":-1*t.scroll.height+"px","margin-right":-1*t.scroll.width+"px","max-height":""}),n.on("scroll"+a,(function(t){e.isFunction(s.onScroll)&&s.onScroll.call(r,{maxScroll:c.y.maxScrollOffset,scroll:n.scrollTop(),size:c.y.size,visible:c.y.visible},{maxScroll:c.x.maxScrollOffset,scroll:n.scrollLeft(),size:c.x.size,visible:c.x.visible}),c.x.isVisible&&c.x.scroll.bar.css("left",n.scrollLeft()*c.x.kx+"px"),c.y.isVisible&&c.y.scroll.bar.css("top",n.scrollTop()*c.y.kx+"px")})),p.on("scroll"+a,(function(){p.scrollTop(0).scrollLeft(0)})),s.disableBodyScroll){var u=function(e){l(e)?c.y.isVisible&&c.y.mousewheel(e):c.x.isVisible&&c.x.mousewheel(e)};p.on("MozMousePixelScroll"+a,u),p.on("mousewheel"+a,u),t.mobile&&p.on("touchstart"+a,(function(t){var i=t.originalEvent.touches&&t.originalEvent.touches[0]||t,r=i.pageX,o=i.pageY,s=n.scrollLeft(),l=n.scrollTop();e(document).on("touchmove"+a,(function(e){var t=e.originalEvent.targetTouches&&e.originalEvent.targetTouches[0]||e;n.scrollLeft(s+r-t.pageX),n.scrollTop(l+o-t.pageY),e.preventDefault()})),e(document).on("touchend"+a,(function(){e(document).off(a)}))}))}e.isFunction(s.onInit)&&s.onInit.apply(this,[n])}e.each(c,(function(t,i){var o=null,p=1,d="x"===t?"scrollLeft":"scrollTop",u=s.scrollStep,m=function(){var e=n[d]();n[d](e+u),1==p&&e+u>=v&&(e=n[d]()),-1==p&&e+u<=v&&(e=n[d]()),n[d]()==e&&o&&o()},v=0;i.scroll||(i.scroll=r._getScroll(s["scroll"+t]).addClass("scroll-"+t),s.showArrows&&i.scroll.addClass("scroll-element_arrows_visible"),i.mousewheel=function(e){if(!i.isVisible||"x"===t&&l(e))return!0;if("y"===t&&!l(e))return c.x.mousewheel(e),!0;var o=-1*e.originalEvent.wheelDelta||e.originalEvent.detail,a=i.size-i.visible-i.offset;return(o>0&&v<a||o<0&&v>0)&&((v+=o)<0&&(v=0),v>a&&(v=a),r.scrollTo=r.scrollTo||{},r.scrollTo[d]=v,setTimeout((function(){r.scrollTo&&(n.stop().animate(r.scrollTo,240,"linear",(function(){v=n[d]()})),r.scrollTo=null)}),1)),e.preventDefault(),!1},i.scroll.on("MozMousePixelScroll"+a,i.mousewheel).on("mousewheel"+a,i.mousewheel).on("mouseenter"+a,(function(){v=n[d]()})),i.scroll.find(".scroll-arrow, .scroll-element_track").on("mousedown"+a,(function(a){if(1!=a.which)return!0;p=1;var l={eventOffset:a["x"===t?"pageX":"pageY"],maxScrollValue:i.size-i.visible-i.offset,scrollbarOffset:i.scroll.bar.offset()["x"===t?"left":"top"],scrollbarSize:i.scroll.bar["x"===t?"outerWidth":"outerHeight"]()},c=0,f=0;return e(this).hasClass("scroll-arrow")?(p=e(this).hasClass("scroll-arrow_more")?1:-1,u=s.scrollStep*p,v=p>0?l.maxScrollValue:0):(p=l.eventOffset>l.scrollbarOffset+l.scrollbarSize?1:l.eventOffset<l.scrollbarOffset?-1:0,u=Math.round(.75*i.visible)*p,v=l.eventOffset-l.scrollbarOffset-(s.stepScrolling?1==p?l.scrollbarSize:0:Math.round(l.scrollbarSize/2)),v=n[d]()+v/i.kx),r.scrollTo=r.scrollTo||{},r.scrollTo[d]=s.stepScrolling?n[d]()+u:v,s.stepScrolling&&(o=function(){v=n[d](),clearInterval(f),clearTimeout(c),c=0,f=0},c=setTimeout((function(){f=setInterval(m,40)}),s.duration+100)),setTimeout((function(){r.scrollTo&&(n.animate(r.scrollTo,s.duration),r.scrollTo=null)}),1),r._handleMouseDown(o,a)})),i.scroll.bar.on("mousedown"+a,(function(o){if(1!=o.which)return!0;var s=o["x"===t?"pageX":"pageY"],l=n[d]();return i.scroll.addClass("scroll-draggable"),e(document).on("mousemove"+a,(function(e){var r=parseInt((e["x"===t?"pageX":"pageY"]-s)/i.kx,10);n[d](l+r)})),r._handleMouseDown((function(){i.scroll.removeClass("scroll-draggable"),v=n[d]()}),o)})))})),e.each(c,(function(e,t){var i="scroll-scroll"+e+"_visible",r="x"==e?c.y:c.x;t.scroll.removeClass(i),r.scroll.removeClass(i),o.removeClass(i)})),e.each(c,(function(t,i){e.extend(i,"x"==t?{offset:parseInt(n.css("left"),10)||0,size:n.prop("scrollWidth"),visible:p.width()}:{offset:parseInt(n.css("top"),10)||0,size:n.prop("scrollHeight"),visible:p.height()})})),this._updateScroll("x",this.scrollx),this._updateScroll("y",this.scrolly),e.isFunction(s.onUpdate)&&s.onUpdate.apply(this,[n]),e.each(c,(function(e,t){var i="x"===e?"left":"top",r="x"===e?"outerWidth":"outerHeight",o="x"===e?"width":"height",a=parseInt(n.css(i),10)||0,l=t.size,c=t.visible+a,p=t.scroll.size[r]()+(parseInt(t.scroll.size.css(i),10)||0);s.autoScrollSize&&(t.scrollbarSize=parseInt(p*c/l,10),t.scroll.bar.css(o,t.scrollbarSize+"px")),t.scrollbarSize=t.scroll.bar[r](),t.kx=(p-t.scrollbarSize)/(l-c)||1,t.maxScrollOffset=l-c})),n.scrollLeft(d.scrollLeft).scrollTop(d.scrollTop).trigger("scroll")},_getScroll:function(t){var i={advanced:['<div class="scroll-element">','<div class="scroll-element_corner"></div>','<div class="scroll-arrow scroll-arrow_less"></div>','<div class="scroll-arrow scroll-arrow_more"></div>','<div class="scroll-element_outer">','<div class="scroll-element_size"></div>','<div class="scroll-element_inner-wrapper">','<div class="scroll-element_inner scroll-element_track">','<div class="scroll-element_inner-bottom"></div>',"</div>","</div>",'<div class="scroll-bar">','<div class="scroll-bar_body">','<div class="scroll-bar_body-inner"></div>',"</div>",'<div class="scroll-bar_bottom"></div>','<div class="scroll-bar_center"></div>',"</div>","</div>","</div>"].join(""),simple:['<div class="scroll-element">','<div class="scroll-element_outer">','<div class="scroll-element_size"></div>','<div class="scroll-element_track"></div>','<div class="scroll-bar"></div>',"</div>","</div>"].join("")};return i[t]&&(t=i[t]),t||(t=i.simple),t="string"==typeof t?e(t).appendTo(this.wrapper):e(t),e.extend(t,{bar:t.find(".scroll-bar"),size:t.find(".scroll-element_size"),track:t.find(".scroll-element_track")}),t},_handleMouseDown:function(t,i){var r=this.namespace;return e(document).on("blur"+r,(function(){e(document).add("body").off(r),t&&t()})),e(document).on("dragstart"+r,(function(e){return e.preventDefault(),!1})),e(document).on("mouseup"+r,(function(){e(document).add("body").off(r),t&&t()})),e("body").on("selectstart"+r,(function(e){return e.preventDefault(),!1})),i&&i.preventDefault(),!1},_updateScroll:function(i,r){var n=this.container,o=this.containerWrapper||n,a="scroll-scroll"+i+"_visible",s="x"===i?this.scrolly:this.scrollx,l=parseInt(this.container.css("x"===i?"left":"top"),10)||0,c=this.wrapper,p=r.size,d=r.visible+l;r.isVisible=p-d>1,r.isVisible?(r.scroll.addClass(a),s.scroll.addClass(a),o.addClass(a)):(r.scroll.removeClass(a),s.scroll.removeClass(a),o.removeClass(a)),"y"===i&&(n.is("textarea")||p<d?o.css({height:d+t.scroll.height+"px","max-height":"none"}):o.css({"max-height":d+t.scroll.height+"px"})),r.size==n.prop("scrollWidth")&&s.size==n.prop("scrollHeight")&&r.visible==c.width()&&s.visible==c.height()&&r.offset==(parseInt(n.css("left"),10)||0)&&s.offset==(parseInt(n.css("top"),10)||0)||(e.extend(this.scrollx,{offset:parseInt(n.css("left"),10)||0,size:n.prop("scrollWidth"),visible:c.width()}),e.extend(this.scrolly,{offset:parseInt(n.css("top"),10)||0,size:this.container.prop("scrollHeight"),visible:c.height()}),this._updateScroll("x"===i?"y":"x",s))}};var n=r;e.fn.scrollbar=function(i,r){return"string"!=typeof i&&(r=i,i="init"),void 0===r&&(r=[]),e.isArray(r)||(r=[r]),this.not("body, .scroll-wrapper").each((function(){var o=e(this),a=o.data(t.data.name);(a||"init"===i)&&(a||(a=new n(o)),a[i]&&a[i].apply(a,r))})),this},e.fn.scrollbar.options=i;var o,a=(o=0,function(e){var i,r,n,s,l,c,p;for(i=0;i<t.scrolls.length;i++)r=(s=t.scrolls[i]).container,n=s.options,l=s.wrapper,c=s.scrollx,p=s.scrolly,(e||n.autoUpdate&&l&&l.is(":visible")&&(r.prop("scrollWidth")!=c.size||r.prop("scrollHeight")!=p.size||l.width()!=c.visible||l.height()!=p.visible))&&(s.init(),n.debug&&window.console&&console.log({scrollHeight:r.prop("scrollHeight")+":"+s.scrolly.size,scrollWidth:r.prop("scrollWidth")+":"+s.scrollx.size,visibleHeight:l.height()+":"+s.scrolly.visible,visibleWidth:l.width()+":"+s.scrollx.visible},!0));clearTimeout(o),o=setTimeout(a,300)});function s(i){if(t.webkit&&!i)return{height:0,width:0};if(!t.data.outer){var r={border:"none","box-sizing":"content-box",height:"200px",margin:"0",padding:"0",width:"200px"};t.data.inner=e("<div>").css(e.extend({},r)),t.data.outer=e("<div>").css(e.extend({left:"-1000px",overflow:"scroll",position:"absolute",top:"-1000px"},r)).append(t.data.inner).appendTo("body")}return t.data.outer.scrollLeft(1e3).scrollTop(1e3),{height:Math.ceil(t.data.outer.offset().top-t.data.inner.offset().top||0),width:Math.ceil(t.data.outer.offset().left-t.data.inner.offset().left||0)}}function l(e){var t=e.originalEvent;return!(t.axis&&t.axis===t.HORIZONTAL_AXIS||t.wheelDeltaX)}}($)},2641:function(){!function(e,t){var i;e.throttle=i=function(i,r,n,o){var a,s=0;function l(){var e=this,l=+new Date-s,c=arguments;function p(){s=+new Date,n.apply(e,c)}function d(){a=t}o&&!a&&p(),a&&clearTimeout(a),o===t&&l>i?p():!0!==r&&(a=setTimeout(o?d:p,o===t?i-l:i))}return"boolean"!=typeof r&&(o=n,n=r,r=t),e.guid&&(l.guid=n.guid=n.guid||e.guid++),l},e.debounce=function(e,r,n){return n===t?i(e,r,!1):i(e,n,!1!==r)}}($)},3745:function(){},7058:function(){},2373:function(){},8827:function(){},2346:function(){},9687:function(){},5213:function(){},8649:function(){},6070:function(){},5181:function(){},9171:function(){},9960:function(){},7555:function(){},9894:function(){},1716:function(){},6782:function(){},6872:function(){},3294:function(){},2384:function(){},5250:function(e,t,i){var r=i(3379),n=i(3745);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},473:function(e,t,i){var r=i(3379),n=i(7058);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},8997:function(e,t,i){var r=i(3379),n=i(2373);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},9663:function(e,t,i){var r=i(3379),n=i(8827);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},9297:function(e,t,i){var r=i(3379),n=i(2346);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},6902:function(e,t,i){var r=i(3379),n=i(9687);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},8240:function(e,t,i){var r=i(3379),n=i(5213);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},9488:function(e,t,i){var r=i(3379),n=i(8649);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},3605:function(e,t,i){var r=i(3379),n=i(6070);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},6694:function(e,t,i){var r=i(3379),n=i(5181);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},5843:function(e,t,i){var r=i(3379),n=i(9171);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},4939:function(e,t,i){var r=i(3379),n=i(9960);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},7317:function(e,t,i){var r=i(3379),n=i(7555);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},5069:function(e,t,i){var r=i(3379),n=i(9894);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},3609:function(e,t,i){var r=i(3379),n=i(1716);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},2759:function(e,t,i){var r=i(3379),n=i(6782);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},8484:function(e,t,i){var r=i(3379),n=i(6872);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},9608:function(e,t,i){var r=i(3379),n=i(3294);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},50:function(e,t,i){var r=i(3379),n=i(2384);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},3379:function(e,t,i){"use strict";var r,n=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),o=[];function a(e){for(var t=-1,i=0;i<o.length;i++)if(o[i].identifier===e){t=i;break}return t}function s(e,t){for(var i={},r=[],n=0;n<e.length;n++){var s=e[n],l=t.base?s[0]+t.base:s[0],c=i[l]||0,p="".concat(l," ").concat(c);i[l]=c+1;var d=a(p),u={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(o[d].references++,o[d].updater(u)):o.push({identifier:p,updater:f(u,t),references:1}),r.push(p)}return r}function l(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=i.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var a=n(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var c,p=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,i,r){var n=i?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=p(t,n);else{var o=document.createTextNode(n),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function u(e,t,i){var r=i.css,n=i.media,o=i.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),o&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var m=null,v=0;function f(e,t){var i,r,n;if(t.singleton){var o=v++;i=m||(m=l(t)),r=d.bind(null,i,o,!1),n=d.bind(null,i,o,!0)}else i=l(t),r=u.bind(null,i,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var i=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<i.length;r++){var n=a(i[r]);o[n].references--}for(var l=s(e,t),c=0;c<i.length;c++){var p=a(i[c]);0===o[p].references&&(o[p].updater(),o.splice(p,1))}i=l}}}},8713:function(e){"use strict";e.exports=BX.Vue},2901:function(e){"use strict";e.exports=BX.Vuex}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,i),o.exports}i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";i(368),i(334),i(2641),i(5250);var e=i(8),t=i.n(e),r=i(4575),n=i.n(r),o=i(3913),a=i.n(o),s=(i(8713),i(2901)),l=function(){function e(i){n()(this,e),this.data=s.store({strict:!0,state:i,mutations:{setValue:function(e,i,r){if(t()(i)!==t()({}))return!1;for(var n in i)e[n]=i[n]}},actions:{getPreviewInVkData:function(e,t){var i=t||!1,r=$('form[name="vkapi_market_export_form"]').serializeArray();r.push({name:"sessid",value:BX.bitrix_sessid()}),r.push({name:"method",value:"previewInVk"}),r.push({name:"isOffer",value:i?1:0}),i?e.commit("setValue",{previewInVkForOfferPreloader:!0}):e.commit("setValue",{previewInVkForProductPreloader:!0}),$.ajax({url:"/bitrix/tools/vkapi.market/ajax.php",type:"POST",dataType:"json",data:r,error:function(e){},success:function(t){t.response||t.error?i?e.commit("setValue",{previewInVkForOffer:t}):e.commit("setValue",{previewInVkForProduct:t}):console.log("previewInVk: Unknown response"),i?e.commit("setValue",{previewInVkForOfferPreloader:!1}):e.commit("setValue",{previewInVkForProductPreloader:!1})}})}}})}return a()(e,[{key:"getStore",value:function(){return this.data}}]),e}(),c=(i(473),i(9713)),p=i.n(c);function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function u(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}i(5069),i(293),i(4391),i(1545),i(7228),i(4235),i(5099),i(3933),i(7581),i(9718),i(8057),i(3004),i(7707);var m=i(8713),v=function(){function e(t){n()(this,e),this.params=u(u({},{prefix:"rule",container:"vkapi-market-condition__area",values:[],conditions:[]}),t),this.containerId=this.params.container,this.initTemplate()}return a()(e,[{key:"setConditionsList",value:function(e){this.params.conditions=e,this.destroyTemplate(),this.initTemplate()}},{key:"initTemplate",value:function(){var e=this;return this.templateEngine=m.createApp({name:"VKapiMarketConditions",data:function(){return{index:"tree",prefix:e.params.prefix,values:e.params.values[0]?e.params.values[0]:{},conditions:e.params.conditions}},computed:{getAllConditionForSelect:function(){var e=[];return this.conditions.forEach((function(t){e.push({id:t.type,name:t.name,group:t.group})})),e}},methods:{getConditionByType:function(t){return e.params.conditions.find((function(e){return e.type==t}))}},render:function(t){var i=this,r=e.params.conditions[0];return t("div",{attrs:{id:params.container},class:"vkapi-market-condition__area"},[t(r.component,{attrs:{"data-type":r.type,"data-index":i.index},props:{root:!0,type:r.type,index:i.index,prefix:i.prefix,restore:this.values}})])}}),this.templateEngine.$mount("#"+e.containerId),new Promise((function(e,t){return e()}))}},{key:"destroyTemplate",value:function(){return this.templateEngine&&(this.templateEngine.$destroy(),this.templateEngine=null),!0}}]),e}();function f(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function h(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?f(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}i(7317),i(2240),i(4939);var _=i(8713),k=function(){function e(t,i){n()(this,e),this.containerId=t,this.params=h(h({},{name:"ALBUMS",values:[],items:[]}),i),this.initTemplate()}return a()(e,[{key:"initTemplate",value:function(){var e=this;return this.templateEngine=_.createApp({name:"VKapiMarketAlbumSelect",data:function(){var t={};return t={name:e.params.name,items:e.params.items,values:[],dragableId:0,dragableSort:0},e.params.values.forEach((function(i){var r=e.params.items.find((function(e){return e.id==i}));r&&t.values.push({id:r.id,name:r.name,sort:10*t.values.length+10,img:r.img,dragable:!1})})),t},computed:{localize:function(){return _.getFilteredPhrases("VKAPI_MARKET_ALBUM_LIST_")}},methods:{deleteItem:function(e){var t=this.values.findIndex((function(t){return t.id==e}));~t&&this.values.splice(t,1)},addItem:function(t){if(0==!!t.id)return console.error("selectItem: data.id is not defined"),!1;var i=e.params.items.find((function(e){return e.id==t.id})),r=this.values.find((function(e){return e.id==t.id}));i&&!r&&this.values.push({id:i.id,name:i.name,sort:10*this.values.length+10,img:i.img,dragable:!1})},onDragStart:function(){return!1},onMouseLeave:function(){var e=this,t=this.values.find((function(t){return t.id==e.dragableId}));t&&(t.dragable=!1),this.dragableId=0,this.dragableSort=0},onMouseDown:function(e){var t=this,i=this.getParent(e.target);this.dragableSort=+i.dataset.sort,this.dragableId=i.dataset.id,this.values.find((function(e){return e.id==t.dragableId})).dragable=!0},onMouseUp:function(e){var t=this,i=this.values.find((function(e){return e.id==t.dragableId}));i&&(i.dragable=!1),this.dragableId=0,this.dragableSort=0},onMouseOver:function(e){var t=this;if(!this.dragableId)return!1;var i=this.getParent(e.target);if(+i.dataset.id==this.dragableId)return!1;+i.dataset.sort>this.dragableSort?this.dragableSort=+i.dataset.sort+5:this.dragableSort=+i.dataset.sort-5;var r=[],n=10;this.values.forEach((function(e){var i=!1;e.id==t.dragableId?i=!0:n+=10,r.push({id:e.id,name:e.name,sort:i?t.dragableSort:n,img:e.img,dragable:i})})),r.sort((function(e,t){return e.sort>t.sort?1:-1})),n=10,r.map((function(e){n+=10,e.sort=n})),this.values=r},getParent:function(e){return e.classList.contains("vkapi-market-album-select-item")?e:this.getParent(e.parentElement)}},template:'<div class="vkapi-market-album-select" @drgastart.prevent.stop="onDragStart">\n                            <div class="vkapi-market-album-select__empty" v-if="!values.length">{{localize.VKAPI_MARKET_ALBUM_LIST_EMPTY}}</div>\n                            <div class="vkapi-market-album-select__items" v-if="values.length"  @mouseleave="onMouseLeave" @mouseup="onMouseLeave" >\n                                \n                                <div class="vkapi-market-album-select-item" v-for="item in values" \n                                :key="item.id" \n                                :class="{\'vkapi-market-album-select-item--dragable\': item.dragable}"\n                                @drgastart.prevent.stop="onDragStart"\n                                @drgaover.prevent.stop="onDragStart"\n                                @mousedown="onMouseDown"\n                                @mouseup="onMouseUp"\n                                @mouseover="onMouseOver"\n                                :data-sort="item.sort"\n                                :data-id="item.id"\n                                >\n                                    <input type="hidden" :name="name + \'[]\'" :value="item.id"  />\n                                    <div class="vkapi-market-album-select-item__delete" @click="deleteItem(item.id)"></div>\n                                    <div class="vkapi-market-album-select-item__img"><img :src="item.img" v-if="item.img" /></div>\n                                    <div class="vkapi-market-album-select-item__name"><span>{{item.name}}</span></div>\n                                </div>\n                                \n                            </div>\n                            <div class="vkapi-market-album-select__action" >\n                                <vkapi-market-select-with-img :items="items" @selectItem="addItem"></vkapi-market-select-with-img>\n                            </div>\n                        </div>'}),this.templateEngine.$mount("#"+e.containerId),new Promise((function(e,t){return e()}))}},{key:"destroyTemplate",value:function(){return this.templateEngine&&(this.templateEngine.$destroy(),this.templateEngine=null),!0}}]),e}();function E(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function T(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?E(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}i(8484),i(1422),i(8997);var P=i(8713),g=function(){function e(t,i){n()(this,e),this.containerId=t,this.params=T(T({},{items:[]}),i),this.initTemplate()}return a()(e,[{key:"initTemplate",value:function(){var e=this;return this.templateEngine=P.createApp({data:function(){return{error:!1,message:"",items:e.params.items,exportId:"",exportIsWorkin:!1,exportIsStopping:!1,steps:{},step:0,errorResponseCounter:0}},computed:{localize:function(){return P.getFilteredPhrases("VKAPI_MARKET_HAND_EXPORT_")},item:function(){var e=this;return this.items.find((function(t){return+t.id==+e.exportId}))},groupUrl:function(){var e="";return this.item&&(e=" //vk.com/club"+this.item.groupId),e}},methods:{getDateTimeForError:function(){var e="",t=new Date;return e+=" "+("0"+t.getHours()).substr(-2),e+=":"+("0"+t.getMinutes()).substr(-2),(e+=":"+("0"+t.getSeconds()).substr(-2))+"  "},exportStartReset:function(){if(this.exportIsWorkin)return!1;this.exportIsWorkin=!0,this.errorResponseCounter=0,this.error=!1,this.message="",this.startExportRequest(!0)},exportStart:function(){if(this.exportIsWorkin)return!1;this.exportIsWorkin=!0,this.errorResponseCounter=0,this.error=!1,this.message="",this.startExportRequest()},exportStop:function(){if(this.exportIsStopping)return!1;this.exportIsStopping=!0},startExportRequest:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,i={stop:+this.exportIsStopping,export_id:this.exportId,all_photo:0,method:"export",reset:e?1:0,sessid:BX.bitrix_sessid()};$.ajax({type:"POST",dataType:"json",data:i,error:function(e){t.message=t.getDateTimeForError()+t.localize.VKAPI_MARKET_HAND_EXPORT_UNKNOWN_ERROR.replace(/#/,JSON.stringify(e)),t.error=!0,t.errorResponseCounter++,t.errorResponseCounter<100?setTimeout((function(){t.startExportRequest()}),3e3):(t.exportIsWorkin=!1,t.exportIsStopping=!1)},success:function(e){if(e&&e.response)if(e.response.state){var i=e.response.state;t.message=!1,t.error=!1,t.step=i.step,t.steps=i.steps,i.complete?t.exportIsWorkin=!1:t.startExportRequest()}else t.exportIsWorkin=!1,t.exportIsStopping=!1;else e&&e.error?(t.message=e.error.msg,t.error=!0,t.exportIsWorkin=!1,t.exportIsStopping=!1):(t.message=t.getDateTimeForError()+t.localize.VKAPI_MARKET_HAND_EXPORT_UNKNOWN_RESPONSE.replace(/#/,JSON.stringify(e)),t.error=!0,t.errorResponseCounter++,t.errorResponseCounter<100?setTimeout((function(){t.startExportRequest()}),3e3):(t.exportIsWorkin=!1,t.exportIsStopping=!1))}})}},template:'\n                    <div class="vkapi-market-hand-export">\n                        <vkapi-market-admin-message :message="message" :error="error"></vkapi-market-admin-message>\n                        \n                         <div class="vkapi-market-hand-export-block__group" v-if="groupUrl">\n                                <a :href="groupUrl" target="_blank">{{localize.VKAPI_MARKET_HAND_EXPORT_OPEN_VK_GROUP}}</a>\n                         </div>\n                            \n                        <div class="vkapi-market-hand-export-block">\n                            <div class="vkapi-market-hand-export-block__title">{{localize.VKAPI_MARKET_HAND_EXPORT_SELECT_ITEM}}</div>\n                            <div class="vkapi-market-hand-export-block__value">\n                               \n                                <select name="export_id" v-model="exportId" :disabled="exportIsWorkin">\n                                    <option v-for="option in items" :key="option.id" :value="option.id">[{{option.id}}] {{option.name}}  &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;  {{option.groupId}} - {{option.groupName}}</option>\n                                </select>\n                                \n                            </div>                           \n                        </div>  \n                        <div class="vkapi-market-hand-export-steps" v-if="steps">                       \n                            <div class="vkapi-market-hand-export-step" v-for="(stepItem, stepIndex) in steps" :class=\'{"vkapi-market-hand-export-step--active" : step >= stepIndex }\' >\n                                <div class="vkapi-market-hand-export-step__name">{{stepItem.name}}</div>\n                                <div class="vkapi-market-hand-export-step__items" v-if="stepItem.items">\n                                    <div class="vkapi-market-hand-export-step__item" v-for="subItem in stepItem.items"\n                                        :class=\'{"vkapi-market-hand-export-step__item--error" : subItem.error, \n                                        "vkapi-market-hand-export-step__item--active":subItem.percent > 0, \n                                         "vkapi-market-hand-export-step__item--complete":subItem.percent >= 100 }\'>\n                                         \n                                         {{subItem.name}}\n                                         \n                                        <div class="vkapi-market-hand-export-step__progress-wrap" v-if="subItem.percent < 100" >\n                                            <div class="vkapi-market-hand-export-step__progress" :style=\'{width : subItem.percent + "%"  }\' ></div>\n                                        </div>                                       \n                                    </div>\n                                </div>\n                            </div>\n                        </div>                        \n                        \n                        <div class="vkapi-market-hand-export__actions">\n                            <div class="vkapi-market-admin-btn vkapi-market-admin-btn--button vkapi-market-admin-btn--success" @click="exportStart" :class=\'{"vkapi-market-admin-btn--preloader" : exportIsWorkin}\' >{{localize.VKAPI_MARKET_HAND_EXPORT_START}}</div>\n                            <div class="vkapi-market-admin-btn vkapi-market-admin-btn--button vkapi-market-admin-btn--success" @click="exportStartReset"   v-if="!exportIsWorkin"  >{{localize.VKAPI_MARKET_HAND_EXPORT_START_RESET}}</div>\n                            <div class="vkapi-market-admin-btn vkapi-market-admin-btn--button vkapi-market-admin-btn--cancel" @click="exportStop" v-if="exportIsWorkin" :class=\'{"vkapi-market-admin-btn--preloader" : exportIsStopping}\' >{{localize.VKAPI_MARKET_HAND_EXPORT_STOP}}</div>\n                        </div>                                           \n                    </div>'}),this.templateEngine.$mount("#"+e.containerId),new Promise((function(e,t){return e()}))}},{key:"destroyTemplate",value:function(){return this.templateEngine&&(this.templateEngine.$destroy(),this.templateEngine=null),!0}}]),e}();function I(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function O(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?I(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}i(9608),i(7210);var b=i(8713),y=function(){function e(t,i){n()(this,e),this.containerId=t,this.params=O(O({},{items:[]}),i),this.initTemplate()}return a()(e,[{key:"initTemplate",value:function(){var e=this;return this.templateEngine=b.createApp({data:function(){return{error:!1,message:"",items:e.params.items,syncId:"",importIsRunning:!1,importIsStopping:!1,steps:{},step:0}},computed:{localize:function(){return b.getFilteredPhrases("VKAPI_MARKET_JS_ORDER_IMPORT_")},item:function(){var e=this;return this.items.find((function(t){return+t.id==+e.syncId}))}},methods:{importStartReset:function(){if(this.importIsRunning)return!1;this.importIsRunning=!0,this.error=!1,this.message="",this.startImportRequest(!0)},importStart:function(){if(this.importIsRunning)return!1;this.importIsRunning=!0,this.error=!1,this.message="",this.startImportRequest()},importStop:function(){if(this.importIsStopping)return!1;this.importIsStopping=!0},startImportRequest:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,i={stop:+this.importIsStopping,syncId:this.syncId,method:"import",reset:e?1:0,sessid:BX.bitrix_sessid()};$.ajax({type:"POST",dataType:"json",data:i,error:function(e){t.message=t.localize.VKAPI_MARKET_JS_ORDER_IMPORT_UNKNOWN_ERROR.replace(/#/,JSON.stringify(e)),t.error=!0,t.importIsRunning=!1,t.importIsStopping=!1},success:function(e){if(e&&e.response)if(e.response.state){var i=e.response.state;t.step=i.step,t.steps=i.steps,i.complete?t.importIsRunning=!1:t.startImportRequest()}else t.importIsRunning=!1,t.importIsStopping=!1;else e&&e.error?(t.message=e.error.msg,t.error=!0,t.importIsRunning=!1,t.importIsStopping=!1):(t.message=t.localize.VKAPI_MARKET_JS_ORDER_IMPORT_UNKNOWN_RESPONSE.replace(/#/,JSON.stringify(e)),t.error=!0,t.importIsRunning=!1,t.importIsStopping=!1)}})}},template:'\n                    <div class="vkapi-market-order-import">\n                        <vkapi-market-admin-message :message="message" :error="error"></vkapi-market-admin-message>\n                        \n                        <div class="vkapi-market-order-import-block">\n                            <div class="vkapi-market-order-import-block__title">{{localize.VKAPI_MARKET_JS_ORDER_IMPORT_SELECT_ITEM}}</div>\n                            <div class="vkapi-market-order-import-block__value">\n                                <select name="import_id" v-model="syncId" :disabled="importIsRunning">\n                                    <option v-for="option in items" :key="option.id" :value="option.id">{{option.name}}</option>\n                                </select>\n                            </div>                            \n                        </div>  \n                        <div class="vkapi-market-order-import-steps" v-if="steps">                       \n                            <div class="vkapi-market-order-import-step" v-for="(stepItem, stepIndex) in steps" :class=\'{"vkapi-market-order-import-step--active" : step >= stepIndex }\' >\n                                <div class="vkapi-market-order-import-step__name">{{stepItem.name}}</div>\n                                <div class="vkapi-market-order-import-step__items" v-if="stepItem.items">\n                                    <div class="vkapi-market-order-import-step__item" v-for="subItem in stepItem.items"\n                                        :class=\'{"vkapi-market-order-import-step__item--error" : subItem.error, \n                                        "vkapi-market-order-import-step__item--active":subItem.percent > 0, \n                                         "vkapi-market-order-import-step__item--complete":subItem.percent >= 100 }\'>\n                                         \n                                         {{subItem.name}}\n                                         \n                                        <div class="vkapi-market-order-import-step__progress-wrap" v-if="subItem.percent < 100" >\n                                            <div class="vkapi-market-order-import-step__progress" :style=\'{width : subItem.percent + "%"  }\' ></div>\n                                        </div>                                       \n                                    </div>\n                                </div>\n                            </div>\n                        </div>                        \n                        \n                        <div class="vkapi-market-order-import__actions">\n                            <div class="vkapi-market-admin-btn vkapi-market-admin-btn--button vkapi-market-admin-btn--success" @click="importStart" :class=\'{"vkapi-market-admin-btn--preloader" : importIsRunning}\' >{{localize.VKAPI_MARKET_JS_ORDER_IMPORT_START}}</div>\n                            <div class="vkapi-market-admin-btn vkapi-market-admin-btn--button vkapi-market-admin-btn--success" @click="importStartReset"   v-if="!importIsRunning"  >{{localize.VKAPI_MARKET_JS_ORDER_IMPORT_START_RESET}}</div>\n                            <div class="vkapi-market-admin-btn vkapi-market-admin-btn--button vkapi-market-admin-btn--cancel" @click="importStop" v-if="importIsRunning" :class=\'{"vkapi-market-admin-btn--preloader" : importIsStopping}\' >{{localize.VKAPI_MARKET_JS_ORDER_IMPORT_STOP}}</div>\n                        </div>                                           \n                    </div>'}),this.templateEngine.$mount("#"+e.containerId),new Promise((function(e,t){return e()}))}},{key:"destroyTemplate",value:function(){return this.templateEngine&&(this.templateEngine.$destroy(),this.templateEngine=null),!0}}]),e}();function R(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function A(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?R(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):R(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}i(3609);var x=i(8713),w=i(2901),C=function(){function e(t,i){n()(this,e),this.containerId=t,this.state=i,this.initTemplate()}return a()(e,[{key:"initTemplate",value:function(){return this.templateEngine=x.createApp({name:"VKapiMarketExportIblockEdit",store:this.state.getStore(),data:function(){return{}},methods:{updatePreviewInVkOffer:$.debounce(1e3,(function(){this.$store.dispatch("getPreviewInVkData",!0)})),updatePreviewInVkProduct:$.debounce(1e3,(function(){this.$store.dispatch("getPreviewInVkData",!1)})),updateConditions:function(){$.ajax({type:"POST",data:{method:"getConditions",sessid:BX.bitrix_sessid(),catalogIblockId:this.catalogIblockId,offerIblockId:this.offerIblockId},dataType:"json",error:function(e){},success:function(e){if(e.response)for(var t in window.BXmakerConditionsJs)window.BXmakerConditionsJs[t].setConditionsList(e.response.conditions)}})}},computed:A(A({localize:function(){return x.getFilteredPhrases("VKAPI_MARKET_EXPORT_IBLOCK_EDIT_")},getLinkPropertyList:function(){var e=this;return this.iblockPropertyItems.filter((function(t){return t.iblockId==e.offerIblockId&&"E"==t.propertyType}))},isCatalogSelected:function(){var e=this,t=this.iblockItems.find((function(t){return t.id==e.catalogIblockId}));return t&&t.isCatalog},catalogIblockId:{get:function(){return this.$store.state.catalogIblockId},set:function(e){var t=this.iblockItems.find((function(t){return t.id==e}));t&&(t.isCatalog?this.$store.commit("setValue",{catalogIblockId:e,offerIblockId:t.offerIblockId,linkPropertyId:t.linkPropertyId}):this.$store.commit("setValue",{catalogIblockId:e,offerIblockId:!1,linkPropertyId:!1})),this.updateConditions(),this.updatePreviewInVkProduct(),this.updatePreviewInVkOffer()}},offerIblockId:{get:function(){return this.$store.state.offerIblockId},set:function(e){this.$store.commit("setValue",{offerIblockId:e}),this.updatePreviewInVkProduct(),this.updatePreviewInVkOffer(),this.updateConditions()}},linkPropertyId:{get:function(){return this.$store.state.linkPropertyId},set:function(e){this.$store.commit("setValue",{linkPropertyId:e}),this.updatePreviewInVkProduct(),this.updatePreviewInVkOffer()}},currencyId:{get:function(){return this.$store.state.currencyId},set:function(e){this.$store.commit("setValue",{currencyId:e}),this.updatePreviewInVkProduct(),this.updatePreviewInVkOffer()}}},w.mapState(["hasCatalog","hasCurrency","iblockItems","iblockPropertyItems","currencyItems"])),{},{offerIblockList:function(){var e=this;return this.catalogIblockId?this.iblockItems.filter((function(t){return t.id!=e.catalogIblockId})):[]}}),template:'\n                    <div class="vkapi-market-export-iblock-edit">\n                        \n                        <div class="vkapi-market-admin-field">\n                            <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_IBLOCK_EDIT_CATALOG_IBLOCK_ID}}<span class="vkapi-market-admin-field__req"></span></div>\n                            <div class="vkapi-market-admin-field__value">\n                                <select name="CATALOG_IBLOCK_ID" v-model="catalogIblockId" >\n                                    <option v-for="option in iblockItems" :key="option.id" :value="option.id">{{option.name}}</option>\n                                </select>\n                            </div>\n                        </div>  \n                        \n                        <div class="vkapi-market-admin-field" v-if="catalogIblockId">\n                            <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_IBLOCK_EDIT_OFFER_IBLOCK_ID}}</div>\n                            <div class="vkapi-market-admin-field__value">\n                                <select name="OFFER_IBLOCK_ID" v-model="offerIblockId" :disabled="isCatalogSelected" >\n                                    <option v-for="option in offerIblockList" :key="option.id" :value="option.id">{{option.name}}</option>\n                                </select>\n                            </div>\n                        </div>\n                        \n                        <div class="vkapi-market-admin-field" v-if="offerIblockId">\n                            <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_IBLOCK_EDIT_LINK_PROPERTY_ID}}<span class="vkapi-market-admin-field__req"></span></div>\n                            <div class="vkapi-market-admin-field__value">\n                                <select name="LINK_PROPERTY_ID" v-model="linkPropertyId" :disabled="isCatalogSelected">\n                                    <option v-for="option in getLinkPropertyList" :key="option.id" :value="option.id">{{option.name}}</option>\n                                </select>\n                            </div>\n                        </div> \n                        \n                        <div class="vkapi-market-admin-field" v-if="hasCurrency">\n                            <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_IBLOCK_EDIT_CURRENCY}}<span class="vkapi-market-admin-field__req"></span></div>\n                            <div class="vkapi-market-admin-field__value">\n                                <select name="CURRENCY_ID" v-model="currencyId" >\n                                    <option v-for="option in currencyItems" :key="option.id" :value="option.id">{{option.name}}</option>\n                                </select>\n                            </div>\n                        </div>                                        \n                                                      \n                    </div>'}),this.templateEngine.$mount("#"+this.containerId),new Promise((function(e,t){return e()}))}},{key:"destroyTemplate",value:function(){return this.templateEngine&&(this.templateEngine.$destroy(),this.templateEngine=null),!0}}]),e}(),M=(i(2759),i(319)),V=i.n(M),S=(i(9488),i(9663),i(8713));function D(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function L(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?D(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):D(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}S.component("vkapi-market-admin-empty",{computed:{localize:function(){return S.getFilteredPhrases("VKAPI_MARKET_ADMIN_EMPTY")}},template:'\n            <div class="vkapi-market-admin-empty">           \n              <slot>{{localize.VKAPI_MARKET_ADMIN_EMPTY}}</slot>\n            </div>\n            '});var K=i(8713),N=i(2901);function z(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function j(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?z(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):z(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}K.component("vkapi-market-export-properties-select",{props:{list:Array},data:function(){return{search:"",isOffer:this.isOfferMode||!1}},computed:L(L({},N.mapState(["iblockPropertyItems","catalogIblockId","offerIblockId"])),{},{localize:function(){return K.getFilteredPhrases("VKAPI_MARKET_EXPORT_PROPERTIES_SELECT_")},listItems:function(){var e=this;return this.list.filter((function(t){return!e.search||!!~t.name.toLowerCase().indexOf(e.search.toLowerCase())}))}}),methods:{onSelect:function(e){this.$emit("onSelect",e)}},template:'\n            <div class="vkapi-market-export-properties-select" >      \n                <div class="vkapi-market-export-properties-select__title">{{localize.VKAPI_MARKET_EXPORT_PROPERTIES_SELECT_TITLE}}</div>\n                <div class="vkapi-market-export-properties-select__search">\n                    <input type="text" v-model="search" :placeholder="localize.VKAPI_MARKET_EXPORT_PROPERTIES_SELECT_SEARCH">\n                    <div class="vkapi-market-export-properties-select__search-clear"></div>\n                </div>\n                \n                <vkapi-market-admin-empty v-if="listItems.length <= 0">\n                    {{localize.VKAPI_MARKET_EXPORT_PROPERTIES_SELECT_EMPTY}}\n                </vkapi-market-admin-empty>\n                \n                <div class="vkapi-market-export-properties-select__list scrollbar-outer">                                        \n                    <div class="vkapi-market-export-properties-select-group" >\n                        <div class="vkapi-market-export-properties-select-group__content">\n                            <div \n                            v-for="item in listItems" \n                            :data-key="item.id" \n                            @click="onSelect(item.id)" \n                            class="vkapi-market-export-properties-select-item"\n                            :class="{\'vkapi-market-export-properties-select-item--offer\' : item.isOffer}"\n                            >{{item.name}}</div>\n                        </div>\n                    </div>\n                </div>     \n                \n                    \n                \n            </div>\n            '}),i(8240);var F=i(8713),X=i(2901);function U(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function G(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?U(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):U(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}F.component("vkapi-market-export-properties-item",{props:{id:[Number,String]},computed:j(j({},X.mapState(["iblockPropertyItems","offerIblockId"])),{},{item:function(){var e=this;return this.iblockPropertyItems.find((function(t){return t.id===e.id}))},isOffer:function(){return+this.item.iblockId==+this.offerIblockId}}),template:'\n            <div class="vkapi-market-export-properties-item" :class="{\'vkapi-market-export-properties-item--offer\': isOffer}" > \n                <div class="vkapi-market-export-properties-item__value">\n                    {{item.name}}\n                </div>\n                <div class="vkapi-market-export-properties-item__delete" @click="$emit(\'onDelete\', item.id)" />               \n            </div>\n            '});var B=i(8713),H=i(2901);function W(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?W(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):W(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}B.component("vkapi-market-export-properties",{props:{selected:Array},data:function(){return{list:V()(this.selected)}},methods:{onSelect:function(e){this.list.push(e)},onDelete:function(e){this.list=this.list.filter((function(t){return t!==e}))}},computed:G(G({},H.mapState(["iblockPropertyItems","catalogIblockId","offerIblockId"])),{},{localize:function(){return B.getFilteredPhrases("VKAPI_MARKET_EXPORT_PROPERTIES_")},allProperties:function(){var e=this,t=[];return this.iblockPropertyItems.forEach((function(i){if(+i.iblockId!=+e.offerIblockId&&+i.iblockId!=+e.catalogIblockId)return!1;var r=!1;return("L"==i.propertyType||"S"==i.propertyType&&"directory"==i.userType)&&(r=!0),r?(t.push({id:i.id,name:i.name,isOffer:+i.iblockId==+e.offerIblockId}),!1):void 0})),t},propertiesList:function(){var e=[];return e.concat(this.allProperties.filter((function(e){return!e.isOffer})),this.allProperties.filter((function(e){return e.isOffer})))},availablePropertiesList:function(){var e=this;return this.propertiesList.filter((function(t){return!e.list.includes(t.id)}))},selectedId:function(){var e=this;return this.propertiesList.filter((function(t){return e.list.includes(t.id)})).map((function(e){return e.id}))}}),template:'\n            <div class="vkapi-market-export-properties" >\n            \n                <div class="vkapi-market-export-properties__title">\n                    {{localize.VKAPI_MARKET_EXPORT_PROPERTIES_TITLE}}\n                </div>\n                 <div class="vkapi-market-export-properties__subtitle">\n                    {{localize.VKAPI_MARKET_EXPORT_PROPERTIES_SUBTITLE}}\n                </div>\n                <div class="vkapi-market-export-properties__area">\n                     <div class="vkapi-market-export-properties__search">\n                        <vkapi-market-export-properties-select @onSelect="onSelect" :list="availablePropertiesList" />\n                    </div>\n                    <div class="vkapi-market-export-properties__list">\n                        <vkapi-market-export-properties-item v-for="id in list" :key="id" :id="id" @onDelete="onDelete" />   \n                        \n                        <vkapi-market-admin-empty v-if="list.length <= 0" >\n                         {{localize.VKAPI_MARKET_EXPORT_PROPERTIES_EMPTY}}\n                        </vkapi-market-admin-empty>\n                    </div> \n                    \n                    \n                    <input type="hidden" name="PROPERTIES[]" v-for="id in selectedId" :value="id" :key="id" />\n                </div>\n            </div>\n            '}),i(3605);var q=i(8713),Q=i(2901);function J(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Z(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?J(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):J(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}q.component("vkapi-market-export-template",{props:{isOfferMode:Boolean,items:Array},data:function(){return{search:"",isOffer:this.isOfferMode||!1}},methods:{selectPlaceholder:function(e){if(this.$refs.content.classList.contains("lastfocus")){var t=+this.$refs.content.dataset.position;this.content&&t<this.content.length?this.content=this.content.substr(0,t)+"{"+e+"}"+this.content.substr(t):this.content+="{"+e+"}"}if(this.$refs.contentBefore.classList.contains("lastfocus")){var i=+this.$refs.contentBefore.dataset.position;this.contentBefore&&i<this.contentBefore.length?this.contentBefore=this.contentBefore.substr(0,i)+"{"+e+"}"+this.contentBefore.substr(i):this.contentBefore+="{"+e+"}"}if(this.$refs.contentAfter.classList.contains("lastfocus")){var r=+this.$refs.contentAfter.dataset.position;this.contentAfter&&r<this.contentAfter.length?this.contentAfter=this.contentAfter.substr(0,r)+"{"+e+"}"+this.contentAfter.substr(r):this.contentAfter+="{"+e+"}"}},onBlur:function(e){var t=!!e.target&&e.target;t.dataset.position=this.getCuretPosition(t)},onFocus:function(e){e.target&&e.target,$(this.$refs.fields).find("textarea.lastfocus").removeClass("lastfocus"),$(e.target).addClass("lastfocus")},getCuretPosition:function(e){if(!e)return 0;if(e.selectionStart)return e.selectionStart;if(document.selection){var t=document.selection.createRange(),i=t.duplicate();return t.collapse(!0),i.moveToElementText(e),i.setEndPoint("EndToEnd",t),i.text.length}return 0},trim:function(e){return e.replace(/([\r\n\t]+)$/,"").replace(/^([\r\n\t]+)/,"")},getPrepiredDescriptionPart:function(e){var t=!1;if(t=(e=e||"").match(/(\{[^}]+\})/gi))for(var i in t){var r=t[i].replace(/[\{\}]/g,"");"BR"==r||(e="EMPTY"==r?e.replace(t[i],"\n\n"):this.getPlaceholderHtml[r]?e.replace(t[i],this.getPlaceholderHtml[r]):e.replace(t[i],"{DEL}"))}return e},removeFromTemplateEmptyBlock:function(e){var t=e.match(/(\[[^\]]+\]*)/gi);if(t)for(var i in t){var r=t[i],n=new RegExp("("+r.replace(/([\[\]\{\}]{1})/g,"\\$1")+"\n*)");e=~r.indexOf("{DEL}")?e.replace(n,""):/\{BR\}\s+\]/.test(r)?e.replace(r,r.replace(/(\}\s+])$/,"}]")):e.replace(n,r.replace(/([\]\[]{1})/g,""))}return e},removeFromTemplateBrPlaceholder:function(e){return e.replace(/({BR}|\r\n|\n)/g,"<br>")},removeFromTemplateDoubleSpace:function(e){return e.replace("&nbsp;"," ").replace(/([\x20]+)/g," ")},startLookFor:function(){var e=[];if(e.push("iblockfix=y"),this.isOffer&&this.offerIblockId)e.push("IBLOCK_ID="+this.offerIblockId);else{if(this.isOffer||!this.catalogIblockId)return!1;e.push("IBLOCK_ID="+this.catalogIblockId)}window.open("/bitrix/admin/vkapi.market_iblock_element_search.php?"+e.join("&"),"","menubar=no,location=yes,resizable=yes,scrollbars=yes,status=no"),$(window).on("VKapiMarketConditionIblockElementSelectedValue",this.selectedElementIdForPreview)},selectedElementIdForPreview:function(e,t){if($(window).off("VKapiMarketConditionIblockElementSelectedValue",this.selectedElementIdForPreview),0==!!t.title)return!1;this.isOffer?(this.previewInVkOfferName=t.title,this.previewInVkOfferId=t.id):(this.previewInVkProductName=t.title,this.previewInVkProductId=t.id)}},computed:Y(Y({},Q.mapState(["baseTemplatePlaceholderItems","productTemplatePlaceholderItems","offerTemplatePlaceholderItems","iblockPropertyItems","catalogIblockId","offerIblockId","previewInVkForOffer","previewInVkForProduct","extendedGoods","offerCombine"])),{},{localize:function(){return q.getFilteredPhrases("VKAPI_MARKET_EXPORT_TEMPLATE_")},fieldPrefix:function(){return this.isOffer?"OFFER_":"PRODUCT_"},defaultText:{get:function(){return this.isOffer?this.$store.state.offerDefaultText:this.$store.state.productDefaultText},set:function(e){this.isOffer?this.$store.commit("setValue",{offerDefaultText:e}):this.$store.commit("setValue",{productDefaultText:e})}},content:{get:function(){return this.isOffer?this.$store.state.offerTemplate:this.$store.state.productTemplate},set:function(e){this.isOffer?(this.$store.commit("setValue",{offerTemplate:e}),this.$root.updatePreviewInVkOffer()):(this.$store.commit("setValue",{productTemplate:e}),this.$root.updatePreviewInVkProduct())}},contentBefore:{get:function(){return this.isOffer?this.$store.state.offerTemplateBefore:""},set:function(e){this.isOffer&&(this.$store.commit("setValue",{offerTemplateBefore:e}),this.$root.updatePreviewInVkOffer())}},contentAfter:{get:function(){return this.isOffer?this.$store.state.offerTemplateAfter:""},set:function(e){this.isOffer&&(this.$store.commit("setValue",{offerTemplateAfter:e}),this.$root.updatePreviewInVkOffer())}},previewInVkProductId:{get:function(){return this.$store.state.previewInVkProductId},set:function(e){this.$store.commit("setValue",{previewInVkProductId:e}),this.$root.updatePreviewInVkProduct()}},previewInVkProductName:{get:function(){return this.$store.state.previewInVkProductName},set:function(e){this.$store.commit("setValue",{previewInVkProductName:e})}},previewInVkOfferId:{get:function(){return this.$store.state.previewInVkOfferId},set:function(e){this.$store.commit("setValue",{previewInVkOfferId:e}),this.$root.updatePreviewInVkOffer()}},previewInVkOfferName:{get:function(){return this.$store.state.previewInVkOfferName},set:function(e){this.$store.commit("setValue",{previewInVkOfferName:e})}},getPlaceholderHtml:function(){var e=this,t={};return this.baseTemplatePlaceholderItems.forEach((function(e){t[e.id]='<div class="vkapi-market-export-template-placeholder-item vkapi-market-export-template-placeholder-item--base">'+e.name+"</div>"})),this.productTemplatePlaceholderItems.forEach((function(e){t[e.id]='<div class="vkapi-market-export-template-placeholder-item vkapi-market-export-template-placeholder-item--product">'+e.name+"</div>"})),this.iblockPropertyItems.forEach((function(i){i.iblockId==e.catalogIblockId&&(t["PROPERTY_"+i.id]='<div class="vkapi-market-export-template-placeholder-item vkapi-market-export-template-placeholder-item--product  vkapi-market-export-template-placeholder-item--product-prop">'+i.name+"</div>")})),this.offerTemplatePlaceholderItems.forEach((function(e){t[e.id]='<div class="vkapi-market-export-template-placeholder-item vkapi-market-export-template-placeholder-item--offer">'+e.name+"</div>"})),this.iblockPropertyItems.forEach((function(i){i.iblockId==e.offerIblockId&&(t["PROPERTY_"+i.id]='<div class="vkapi-market-export-template-placeholder-item vkapi-market-export-template-placeholder-item--offer  vkapi-market-export-template-placeholder-item--offer-prop">'+i.name+"</div>")})),t},getPreview:function(){var e="",t="",i="",r=this.content,n=this.contentBefore,o=this.contentAfter;return t=this.getPrepiredDescriptionPart(n),t=this.removeFromTemplateBrPlaceholder(t),t=this.removeFromTemplateDoubleSpace(t),e=this.getPrepiredDescriptionPart(r),e=this.removeFromTemplateBrPlaceholder(e),e=this.removeFromTemplateDoubleSpace(e),i=this.getPrepiredDescriptionPart(o),i=this.removeFromTemplateBrPlaceholder(i),i=this.removeFromTemplateDoubleSpace(i),this.isOffer&&this.offerCombine&&!this.extendedGoods?this.trim(t+e+e+i):this.trim(e)}}),template:'\n            <div class="vkapi-market-export-template" >\n            \n                \n                <div class="vkapi-market-export-template__column vkapi-market-export-template__column--left" ref="fields">\n                \n                    <div class="vkapi-market-export-template__constructor">\n                        <div class="vkapi-market-export-template__title">\n                        {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_DEFAULT_TEXT}}\n                        <span class="vkapi-market-admin-field__req" />\n                        </div>\n                    </div>     \n                    \n                    <div class="vkapi-market-export-template__default-text" >\n                        <textarea :name="fieldPrefix + \'DEFAULT_TEXT\'" \n                        v-model="defaultText" \n                        @blur.prevent.stop="onBlur" \n                        @focus="onFocus" \n                        ref="defaultText"\n                        :placeholder="localize.VKAPI_MARKET_EXPORT_TEMPLATE_DEFAULT_TEXT_PLACEHOLDER"\n                        ></textarea>\n                    </div>          \n                    \n                    <div class="vkapi-market-export-template__constructor">\n                        <div class="vkapi-market-export-template__title">\n                        {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_CONSTRUCTOR}}\n                        <span class="vkapi-market-admin-field__req" />\n                        </div>\n                    </div>\n                      \n                                         \n                    <div class="vkapi-market-export-template__content" v-if="isOffer" v-show="offerCombine && !extendedGoods">\n                        <div class="vkapi-market-export-template__content-title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_BEFORE}}</div>\n                        <textarea :name="fieldPrefix + \'TEMPLATE_BEFORE\'" \n                            v-model="contentBefore" \n                            @blur.prevent.stop="onBlur" \n                            @focus="onFocus" \n                            ref="contentBefore" />\n                    </div>\n                                  \n                    <div class="vkapi-market-export-template__content">\n                         <div v-if="isOffer && offerCombine && !extendedGoods"  class="vkapi-market-export-template__content-title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_CONTENT}}</div>\n                        <textarea :name="fieldPrefix + \'TEMPLATE\'" v-model="content" @blur.prevent.stop="onBlur" @focus="onFocus" ref="content"></textarea>\n                    </div>\n                    \n                    \n                    <div class="vkapi-market-export-template__content" v-if="isOffer" v-show="offerCombine && !extendedGoods">\n                        <div class="vkapi-market-export-template__content-title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_AFTER}}</div>\n                        <textarea :name="fieldPrefix + \'TEMPLATE_AFTER\'" \n                            v-model="contentAfter" \n                            @blur.prevent.stop="onBlur" \n                            @focus="onFocus" \n                            ref="contentAfter"\n                             />\n                    </div>\n                               \n                    <vkapi-market-export-template-placeholder :isOfferMode="isOffer" @selectPlaceholder="selectPlaceholder"></vkapi-market-export-template-placeholder>\n                   \n                </div>\n                \n                <div class="vkapi-market-export-template__column vkapi-market-export-template__column--right">\n                    \n                    \n                    <div class="vkapi-market-export-template__constructor">\n                        <div class="vkapi-market-export-template__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_PREVIEW}}</div>\n                    </div>\n                \n                    <div class="vkapi-market-export-template__preview" v-html="getPreview"></div>\n                    \n                    <div class="vkapi-market-export-template__vk">                    \n                        <div class="vkapi-market-export-template__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_PREVIEW_IN_VK}}</div>\n                        \n                        <div class="vkapi-market-export-template__vk-id" v-if="isOffer">\n                            <div class="vkapi-market-export-template__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_PREVIEW_IN_VK_OFFER_ID}}</div>\n                             \n                           <input type="hidden" name="PREVIEW_IN_VK_OFFER_ID" v-model="previewInVkOfferId"  />\n                           <input type="hidden" name="PREVIEW_IN_VK_OFFER_NAME" v-model="previewInVkOfferName"  />\n                           <div class="vkapi-market-export-template__vk-select" @click="startLookFor" v-html="(previewInVkOfferName||localize.VKAPI_MARKET_EXPORT_TEMPLATE_PREVIEW_IN_VK_SELECT_ID)"></div>\n                        </div>\n                        \n                        \n                        <div class="vkapi-market-export-template__vk-id" v-if="!isOffer" >\n                            <div class="vkapi-market-export-template__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_PREVIEW_IN_VK_PRODUCT_ID}}</div>\n                                                      \n                           <input type="hidden" name="PREVIEW_IN_VK_PRODUCT_ID" v-model="previewInVkProductId"  />\n                           <input type="hidden" name="PREVIEW_IN_VK_PRODUCT_NAME" v-model="previewInVkProductName"  />\n                           <div class="vkapi-market-export-template__vk-select" @click="startLookFor" v-html="(previewInVkProductName||localize.VKAPI_MARKET_EXPORT_TEMPLATE_PREVIEW_IN_VK_SELECT_ID)"></div>\n                        </div>\n                                                \n                        <vkapi-market-export-preview-vk :is-offer-mode="isOffer"></vkapi-market-export-preview-vk>\n                        \n                    </div>\n                                       \n                    \n                </div>\n                \n                </div>\n            '}),i(5843);var ee=i(8713),te=i(2901);function ie(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function re(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ie(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}ee.component("vkapi-market-export-template-placeholder",{props:{isOfferMode:Boolean},data:function(){return{search:"",isOffer:this.isOfferMode||!1}},mounted:function(){},computed:Z(Z({},te.mapState(["baseTemplatePlaceholderItems","productTemplatePlaceholderItems","offerTemplatePlaceholderItems","iblockPropertyItems","catalogIblockId","offerIblockId"])),{},{localize:function(){return ee.getFilteredPhrases("VKAPI_MARKET_EXPORT_TEMPLATE_PLACEHOLDER_")},getBaseItems:function(){var e=this;return this.baseTemplatePlaceholderItems.filter((function(t){return!!~t.name.toLowerCase().indexOf(e.search.toLowerCase())}))},getProductItems:function(){var e=this,t=[];return t=this.productTemplatePlaceholderItems.filter((function(t){return!e.search||!!~t.name.toLowerCase().indexOf(e.search.toLowerCase())})),this.getCatalogProperties.forEach((function(i){e.search&&!~i.name.toLowerCase().indexOf(e.search.toLowerCase())||t.push(i)})),t},getOfferItems:function(){var e=this,t=[];return this.isOffer?(t=this.offerTemplatePlaceholderItems.filter((function(t){return!e.search||!!~t.name.toLowerCase().indexOf(e.search.toLowerCase())})),this.getOfferProperties.forEach((function(i){e.search&&!~i.name.toLowerCase().indexOf(e.search.toLowerCase())||t.push(i)})),t):t},getCatalogProperties:function(){var e=this,t=[];return this.iblockPropertyItems.forEach((function(i){i.iblockId==e.catalogIblockId&&t.push({id:"PROPERTY_"+i.id,name:i.name})})),t},getOfferProperties:function(){var e=this,t=[];return this.iblockPropertyItems.forEach((function(i){i.iblockId==e.offerIblockId&&t.push({id:"PROPERTY_"+i.id,name:i.name})})),t}}),methods:{selectPlaceholder:function(e){this.$emit("selectPlaceholder",e)}},template:'\n            <div class="vkapi-market-export-template-placeholder" >      \n             <div class="vkapi-market-export-template-placeholder__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_PLACEHOLDER_ACTION}}</div>\n                <div class="vkapi-market-export-template-placeholder__search">\n                    <input type="text" v-model="search" :placeholder="localize.VKAPI_MARKET_EXPORT_TEMPLATE_PLACEHOLDER_SERACH_PLACEHOLDER">\n                    <div class="vkapi-market-export-template-placeholder__search-clear"></div>\n                </div>\n                <div class="vkapi-market-export-template-placeholder__list scrollbar-outer" ref="list">\n                    \n                    <div class="vkapi-market-export-template-placeholder-group" v-if="getBaseItems.length">\n                        <div class="vkapi-market-export-template-placeholder-group__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_PLACEHOLDER_GROUP_BASE}}</div>\n                        <div class="vkapi-market-export-template-placeholder-group__content">\n                            <div v-for="item in getBaseItems" :data-key="item.id" @click="selectPlaceholder(item.id)" class="vkapi-market-export-template-placeholder-item vkapi-market-export-template-placeholder-item--base">{{item.name}}</div>\n                        </div>\n                    </div>\n                    \n                    <div class="vkapi-market-export-template-placeholder-group" v-if="getProductItems.length">\n                        <div class="vkapi-market-export-template-placeholder-group__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_PLACEHOLDER_GROUP_PRODUCT}}</div>\n                        <div class="vkapi-market-export-template-placeholder-group__content">\n                            <div v-for="item in getProductItems" :data-key="item.id" @click="selectPlaceholder(item.id)" class="vkapi-market-export-template-placeholder-item vkapi-market-export-template-placeholder-item--product">{{item.name}}</div>\n                        </div>\n                    </div>\n                    \n                    <div class="vkapi-market-export-template-placeholder-group" v-if="getOfferItems.length">\n                        <div class="vkapi-market-export-template-placeholder-group__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_PLACEHOLDER_GROUP_OFFER}}</div>\n                        <div class="vkapi-market-export-template-placeholder-group__content">\n                            <div v-for="item in getOfferItems" :data-key="item.id" @click="selectPlaceholder(item.id)" class="vkapi-market-export-template-placeholder-item vkapi-market-export-template-placeholder-item--offer">{{item.name}}</div>\n                        </div>\n                    </div>\n                    \n                </div>\n            </div>\n            '}),i(6694);var ne=i(8713),oe=i(2901);function ae(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function se(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ae(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}ne.component("vkapi-market-export-preview-vk",{props:{isOfferMode:Boolean},data:function(){return{activeImg:0,isOffer:this.isOfferMode||!1}},methods:{getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},getSrc:function(e){return"url('"+e+"')"}},computed:re(re({},oe.mapState(["previewInVkForOffer","previewInVkForProduct","previewInVkForOfferPreloader","previewInVkForProductPreloader"])),{},{localize:function(){return ne.getFilteredPhrases("VKAPI_MARKET_EXPORT_PREVIEW_VK_")},data:function(){return this.isOffer?!(!this.previewInVkForOffer||!this.previewInVkForOffer.response)&&this.previewInVkForOffer.response:!(!this.previewInVkForProduct||!this.previewInVkForProduct.response)&&this.previewInVkForProduct.response},error:function(){return this.isOffer?!(!this.previewInVkForOffer||!this.previewInVkForOffer.error)&&this.previewInVkForOffer.error:!(!this.previewInVkForProduct||!this.previewInVkForProduct.error)&&this.previewInVkForProduct.error},isPreloader:function(){return this.isOffer?this.previewInVkForOfferPreloader:this.previewInVkForProductPreloader},getDate:function(){return this.localize.VKAPI_MARKET_EXPORT_PREVIEW_VK_DATE.replace(/#SHOW#/,this.getRandomInt(230,1e3)).replace(/#SHOW_TODAY#/,this.getRandomInt(1,220)).replace(/#DATE#/,BX.Main.Date.format("g M Y").toString().toLowerCase()).replace(/#TIME#/,BX.Main.Date.format("H:i"))},getDescription:function(){return this.data?this.data.description.replace(/[\n]/g,"<br>"):""},getName:function(){return this.data?this.data.name:"-"},getSku:function(){return this.data?this.data.sku:""},getPrice:function(){return this.data?this.data.price:""},getOldPrice:function(){return!!this.data&&this.data.old_price},getDiscount:function(){return this.data&&this.data.old_price,Math.round((this.data.old_price-this.data.price)/this.data.old_price*100)},getImgList:function(){var e=[];if(this.data)for(var t in this.data.main_photo_id&&this.data.main_photo_id.src&&e.push(this.data.main_photo_id.src),this.data.photo_ids)e.push(this.data.photo_ids[t].src);return e},getMainPicture:function(){var e=this.getImgList;return!!e.length&&(this.activeImg>=e.length&&(this.activeImg=0),e[this.activeImg])}}),template:'\n            <div class="vkapi-market-export-preview-vk" :class="{\'vkapi-market-export-preview-vk--preloader\' : isPreloader}" >  \n                             \n                <div class="vkapi-market-export-preview-vk__error" v-show="error && !isPreloader">{{error.msg}}</div>\n                \n                <div class="vkapi-market-export-preview-vk__container" v-show="!error && !isPreloader" >\n                    <div class="vkapi-market-export-preview-vk__box">\n                        <div class="vkapi-market-export-preview-vk__pictures">\n                            <div class="vkapi-market-export-preview-vk__slider">\n                                <div class="vkapi-market-export-preview-vk__slider-item" \n                                v-for="(src, srcIndex) in getImgList" \n                                :style="{\'background-image\': getSrc(src)}" \n                                :class="{\'vkapi-market-export-preview-vk__slider-item--active\': (srcIndex == activeImg)}"\n                                :data-index="srcIndex"\n                                :data-src="src"\n                                @click="activeImg = srcIndex"></div>\n                            </div>\n                            <div class="vkapi-market-export-preview-vk__picture">\n                                <div class="vkapi-market-export-preview-vk__picture-item" v-if="getMainPicture">\n                                    <img :src="getMainPicture" />\n                                </div>\n                            </div>\n                        </div>\n                        <div class="vkapi-market-export-preview-vk__content">\n                            <div class="vkapi-market-export-preview-vk__group">\n                                <div class="vkapi-market-export-preview-vk__group-img"></div>\n                                <div class="vkapi-market-export-preview-vk__group-name"></div>\n                                <div class="vkapi-market-export-preview-vk__group-subname"></div>\n                            </div>\n                            <div class="vkapi-market-export-preview-vk__product-name">{{getName}}</div>\n                            <div class="vkapi-market-export-preview-vk__product-price">{{getPrice}}</div>\n                            <div class="vkapi-market-export-preview-vk__product-oldprice" v-if="getOldPrice">{{getOldPrice}}</div>\n                            <div class="vkapi-market-export-preview-vk__product-discount" v-if="getDiscount">-{{getDiscount}}%</div>\n                            \n                            <div class="vkapi-market-export-preview-vk__product-buy"></div>\n                        </div>\n                    </div>\n                    <div class="vkapi-market-export-preview-vk__more">\n                        <div class="vkapi-market-export-preview-vk__more-wrap">\n                            <div class="vkapi-market-export-preview-vk__actions">\n                                <div class="vkapi-market-export-preview-vk__like"></div>\n                                <div class="vkapi-market-export-preview-vk__share"></div>\n                                <div class="vkapi-market-export-preview-vk__favorite">{{localize.VKAPI_MARKET_EXPORT_PREVIEW_VK_ACTION_FAVORITE}}</div>\n                                <div class="vkapi-market-export-preview-vk__other">{{localize.VKAPI_MARKET_EXPORT_PREVIEW_VK_ACTION_OTHER}}</div>\n                            </div>\n                            <div class="vkapi-market-export-preview-vk__sku" v-if="getSku">\n                               {{localize.VKAPI_MARKET_EXPORT_PREVIEW_VK_SKU}} {{getSku}}\n                            </div>\n                            \n                            <div class="vkapi-market-export-preview-vk__description" v-html="getDescription"></div>\n                            <div class="vkapi-market-export-preview-vk__date" v-html="getDate"></div>\n                        </div>\n                        <div class="vkapi-market-export-preview-vk__comments">\n                            <div class="vkapi-market-export-preview-vk__comment">\n                                <div class="vkapi-market-export-preview-vk__comment-author"></div>\n                                <div class="vkapi-market-export-preview-vk__comment-text">{{localize.VKAPI_MARKET_EXPORT_PREVIEW_VK_ADD_COMMENT}}</div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            '}),i(6902),i(9297),i(8713).component("vkapi-market-admin-switch",{props:{name:{type:String},value:{type:[String,Number],default:"Y"},active:{type:[Boolean,Array]}},methods:{changeValue:function(){var e,t=this;e=Array.isArray(this.active)?this.active.indexOf(this.value)>-1?this.active.filter((function(e){return e!=t.value})):this.active.concat([this.value]):!this.active,this.$emit("onChange",{name:this.name,value:this.value,active:e})}},computed:{id:function(){return"switch-".concat(Math.random().toString().substr(2))},currentValue:function(){return this.isActive?this.value:""},isActive:function(){return Array.isArray(this.active)?this.active.indexOf(this.value)>-1:!!this.active}},template:'\n            <div class="vkapi-market-admin-switch" @click="changeValue">           \n               <div  class="vkapi-market-admin-switch__input" :class="{\'vkapi-market-admin-switch__input--active\': isActive}"/>     \n               <div  v-if="this.$slots.default" class="vkapi-market-admin-switch__label" >\n                <slot />\n               </div> \n               <input type="text" :name="name" :value="currentValue"  />\n            </div>\n            '});var le=i(8713),ce=i(2901),pe=function(){function e(t,i){n()(this,e),this.containerId=t,this.state=i,this.initTemplate()}return a()(e,[{key:"initTemplate",value:function(){return this.templateEngine=le.createApp({name:"VKapiMarketExportTemplateEdit",store:this.state.getStore(),data:function(){return{}},mounted:function(){this.$nextTick((function(){this.updatePreviewInVkProduct(),this.updatePreviewInVkOffer()}))},computed:se(se({},ce.mapState(["hasCatalog","hasCurrency","iblockItems","iblockPropertyItems","currencyItems","priceItems","catalogIblockId","offerIblockId","linkPropertyId","currencyId","productNameBaseItems","productSkuBaseItems","offerNameBaseItems","offerSkuBaseItems","properties","productPictureBaseItems","offerPictureBaseItems","offerCombine","extendedGoods","descriptionDelete","imageToSquare","disabledOldAlbumDeleting","disabledOldItemDeleting","userGroupList"])),{},{productPrice:{get:function(){return this.$store.state.productPrice},set:function(e){this.$store.commit("setValue",{productPrice:e,productPriceOld:""}),this.updatePreviewInVkProduct()}},productPriceGroups:{get:function(){return this.$store.state.productPriceGroups},set:function(e){this.$store.commit("setValue",{productPriceGroups:e}),this.updatePreviewInVkProduct()}},productPriceOld:{get:function(){return this.$store.state.productPriceOld},set:function(e){this.$store.commit("setValue",{productPriceOld:e}),this.updatePreviewInVkProduct()}},productName:{get:function(){return this.$store.state.productName},set:function(e){this.$store.commit("setValue",{productName:e}),this.updatePreviewInVkProduct()}},productWeight:{get:function(){return this.$store.state.productWeight},set:function(e){this.$store.commit("setValue",{productWeight:e})}},productLength:{get:function(){return this.$store.state.productLength},set:function(e){this.$store.commit("setValue",{productLength:e})}},productHeight:{get:function(){return this.$store.state.productHeight},set:function(e){this.$store.commit("setValue",{productHeight:e})}},productWidth:{get:function(){return this.$store.state.productWidth},set:function(e){this.$store.commit("setValue",{productWidth:e})}},productQuantity:{get:function(){return this.$store.state.productQuantity},set:function(e){this.$store.commit("setValue",{productQuantity:e})}},productPicture:{get:function(){return this.$store.state.productPicture},set:function(e){this.$store.commit("setValue",{productPicture:e}),this.updatePreviewInVkProduct()}},productPictureMore:{get:function(){return this.$store.state.productPictureMore},set:function(e){this.$store.commit("setValue",{productPictureMore:e}),this.updatePreviewInVkProduct()}},productSku:{get:function(){return this.$store.state.productSku},set:function(e){this.$store.commit("setValue",{productSku:e}),this.updatePreviewInVkProduct()}},offerPrice:{get:function(){return this.$store.state.offerPrice},set:function(e){this.$store.commit("setValue",{offerPrice:e,offerPriceOld:""}),this.updatePreviewInVkOffer()}},offerPriceGroups:{get:function(){return this.$store.state.offerPriceGroups},set:function(e){this.$store.commit("setValue",{offerPriceGroups:e}),this.updatePreviewInVkOffer()}},offerPriceOld:{get:function(){return this.$store.state.offerPriceOld},set:function(e){this.$store.commit("setValue",{offerPriceOld:e}),this.updatePreviewInVkOffer()}},offerName:{get:function(){return this.$store.state.offerName},set:function(e){this.$store.commit("setValue",{offerName:e}),this.updatePreviewInVkOffer()}},offerWeight:{get:function(){return this.$store.state.offerWeight},set:function(e){this.$store.commit("setValue",{offerWeight:e})}},offerLength:{get:function(){return this.$store.state.offerLength},set:function(e){this.$store.commit("setValue",{offerLength:e})}},offerHeight:{get:function(){return this.$store.state.offerHeight},set:function(e){this.$store.commit("setValue",{offerHeight:e})}},offerWidth:{get:function(){return this.$store.state.offerWidth},set:function(e){this.$store.commit("setValue",{offerWidth:e})}},offerQuantity:{get:function(){return this.$store.state.offerQuantity},set:function(e){this.$store.commit("setValue",{offerQuantity:e})}},offerPicture:{get:function(){return this.$store.state.offerPicture},set:function(e){this.$store.commit("setValue",{offerPicture:e}),this.updatePreviewInVkOffer()}},offerPictureMore:{get:function(){return this.$store.state.offerPictureMore},set:function(e){this.$store.commit("setValue",{offerPictureMore:e}),this.updatePreviewInVkOffer()}},offerSku:{get:function(){return this.$store.state.offerSku},set:function(e){this.$store.commit("setValue",{offerSku:e}),this.updatePreviewInVkOffer()}},localize:function(){return le.getFilteredPhrases("VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_")},getCatalogPropertyList:function(){var e=this;return this.iblockPropertyItems.filter((function(t){return t.iblockId==e.catalogIblockId}))},getOfferPropertyList:function(){var e=this;return this.iblockPropertyItems.filter((function(t){return t.iblockId==e.offerIblockId}))},getProductPriceList:function(){var e=[],t={};this.priceItems.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE_GROUP,items:[]},this.priceItems.forEach((function(e){return t.items.push({id:"PRICE_"+e.id,name:e.name})})),e.push(t));var i=this.getCatalogPropertyList.filter((function(e){return"S"==e.propertyType||"N"==e.propertyType}));return i.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_PROPERTIES_GROUP,items:[]},i.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),e},getProductPriceOldList:function(){var e=[],t={};this.priceItems.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE_GROUP,items:[]},this.priceItems.forEach((function(e){t.items.push({id:"PRICE_"+e.id,name:e.name})})),e.push(t));var i=this.getCatalogPropertyList.filter((function(e){return"S"==e.propertyType||"N"==e.propertyType}));return i.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_PROPERTIES_GROUP,items:[]},i.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),e},getOfferPriceList:function(){var e=[],t={};e=this.getProductPriceList;var i=this.getOfferPropertyList.filter((function(e){return"S"==e.propertyType||"N"==e.propertyType}));return i.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_PROPERTIES_GROUP,items:[]},i.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),e},getOfferPriceOldList:function(){var e=[],t={};this.priceItems.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE_GROUP,items:[]},this.priceItems.forEach((function(e){t.items.push({id:"PRICE_"+e.id,name:e.name})})),e.push(t));var i=this.getCatalogPropertyList.filter((function(e){return"S"==e.propertyType||"N"==e.propertyType}));return i.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_PROPERTIES_GROUP,items:[]},i.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),(i=this.getOfferPropertyList.filter((function(e){return"S"==e.propertyType||"N"==e.propertyType}))).length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_PROPERTIES_GROUP,items:[]},i.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),e},getProductNameList:function(){var e=[],t={};t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]},this.productNameBaseItems.forEach((function(e){return t.items.push({id:e.id,name:e.name})})),e.push(t);var i=this.getCatalogPropertyList.filter((function(e){return"S"==e.propertyType}));return i.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_PROPERTIES_GROUP,items:[]},i.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),e},getProductSkuList:function(){var e=[],t={};t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]},this.productSkuBaseItems.forEach((function(e){return t.items.push({id:e.id,name:e.name})})),e.push(t);var i=this.getCatalogPropertyList.filter((function(e){return"S"==e.propertyType||"N"==e.propertyType}));return i.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_PROPERTIES_GROUP,items:[]},i.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),e},getOfferNameList:function(){var e=[],t={},i=this.getProductNameList;i&&i[0]&&e.push(i[0]),t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_FIELDS_GROUP,items:[]},this.offerNameBaseItems.forEach((function(e){return t.items.push({id:e.id,name:e.name})})),e.push(t),i&&i[1]&&e.push(i[1]);var r=this.getOfferPropertyList.filter((function(e){return"S"==e.propertyType}));return r.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_PROPERTIES_GROUP,items:[]},r.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),e},getOfferSkuList:function(){var e=[],t={},i=this.getProductSkuList;i&&i[0]&&e.push(i[0]),t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_FIELDS_GROUP,items:[]},this.offerSkuBaseItems.forEach((function(e){return t.items.push({id:e.id,name:e.name})})),e.push(t),i&&i[1]&&e.push(i[1]);var r=this.getOfferPropertyList.filter((function(e){return"S"==e.propertyType||"N"==e.propertyType}));return r.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_PROPERTIES_GROUP,items:[]},r.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),e},getProductPictureList:function(){var e=[],t={};t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]},this.productPictureBaseItems.forEach((function(e){return t.items.push({id:e.id,name:e.name})})),e.push(t);var i=this.getCatalogPropertyList.filter((function(e){return"F"==e.propertyType}));return i.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_PROPERTIES_GROUP,items:[]},i.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),e},getOfferPictureList:function(){var e=[],t={},i=this.getProductPictureList;i&&i[0]&&e.push(i[0]),t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_FIELDS_GROUP,items:[]},this.offerPictureBaseItems.forEach((function(e){return t.items.push({id:e.id,name:e.name})})),e.push(t),i&&i[1]&&e.push(i[1]);var r=this.getOfferPropertyList.filter((function(e){return"F"==e.propertyType}));return r.length&&(t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_PROPERTIES_GROUP,items:[]},r.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),e.push(t)),e},getProductPropertyNGroup:function(){var e=this.getCatalogPropertyList.filter((function(e){return"N"==e.propertyType||"S"==e.propertyType}));if(e.length){var t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_PROPERTIES_GROUP,items:[]};return e.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),t}return!1},getOfferPropertyNGroup:function(){var e=this.getOfferPropertyList.filter((function(e){return"N"==e.propertyType||"S"==e.propertyType}));if(e.length){var t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_PROPERTIES_GROUP,items:[]};return e.forEach((function(e){return t.items.push({id:"PROPERTY_"+e.id,name:e.name})})),t}return!1},getProductWeightList:function(){var e=[],t={};this.hasCatalog&&((t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]}).items.push({id:"CATALOG_WEIGHT",name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_WEIGHT}),e.push(t));var i=this.getProductPropertyNGroup;return i&&e.push(i),e},getProductLengthList:function(){var e=[],t={};this.hasCatalog&&((t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]}).items.push({id:"CATALOG_LENGTH",name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_LENGTH}),e.push(t));var i=this.getProductPropertyNGroup;return i&&e.push(i),e},getProductHeightList:function(){var e=[],t={};this.hasCatalog&&((t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]}).items.push({id:"CATALOG_HEIGHT",name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_HEIGHT}),e.push(t));var i=this.getProductPropertyNGroup;return i&&e.push(i),e},getProductWidthList:function(){var e=[],t={};this.hasCatalog&&((t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]}).items.push({id:"CATALOG_WIDTH",name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_WIDTH}),e.push(t));var i=this.getProductPropertyNGroup;return i&&e.push(i),e},getProductQuantityList:function(){var e=[],t={};this.hasCatalog&&((t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]}).items.push({id:"CATALOG_QUANTITY",name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_QUANTITY}),e.push(t));var i=this.getProductPropertyNGroup;return i&&e.push(i),e},getOfferWeightList:function(){var e=[],t={};return this.hasCatalog&&((t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]}).items.push({id:"CATALOG_WEIGHT",name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_WEIGHT}),e.push(t)),(t=this.getProductPropertyNGroup)&&e.push(t),(t=this.getOfferPropertyNGroup)&&e.push(t),e},getOfferLengthList:function(){var e=[],t={};return this.hasCatalog&&((t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]}).items.push({id:"CATALOG_LENGTH",name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_LENGTH}),e.push(t)),(t=this.getProductPropertyNGroup)&&e.push(t),(t=this.getOfferPropertyNGroup)&&e.push(t),e},getOfferHeightList:function(){var e=[],t={};return this.hasCatalog&&((t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]}).items.push({id:"CATALOG_HEIGHT",name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_HEIGHT}),e.push(t)),(t=this.getProductPropertyNGroup)&&e.push(t),(t=this.getOfferPropertyNGroup)&&e.push(t),e},getOfferWidthList:function(){var e=[],t={};return this.hasCatalog&&((t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]}).items.push({id:"CATALOG_WIDTH",name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_WIDTH}),e.push(t)),(t=this.getProductPropertyNGroup)&&e.push(t),(t=this.getOfferPropertyNGroup)&&e.push(t),e},getOfferQuantityList:function(){var e=[],t={};return this.hasCatalog&&((t={name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_FIELDS_GROUP,items:[]}).items.push({id:"CATALOG_QUANTITY",name:this.localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_QUANTITY}),e.push(t)),(t=this.getProductPropertyNGroup)&&e.push(t),(t=this.getOfferPropertyNGroup)&&e.push(t),e}}),methods:{updatePreviewInVkOffer:$.debounce(1e3,(function(){this.$store.dispatch("getPreviewInVkData",!0)})),updatePreviewInVkProduct:$.debounce(1e3,(function(){this.$store.dispatch("getPreviewInVkData",!1)})),descriptionDeleteChange:function(e){this.$store.commit("setValue",{descriptionDelete:e.active}),this.updatePreviewInVkProduct(),this.updatePreviewInVkOffer()},imageToSquareChange:function(e){this.$store.commit("setValue",{imageToSquare:e.active}),this.updatePreviewInVkProduct(),this.updatePreviewInVkOffer()},disabledOldAlbumDeletingChange:function(e){this.$store.commit("setValue",{disabledOldAlbumDeleting:e.active})},disabledOldItemDeletingChange:function(e){this.$store.commit("setValue",{disabledOldItemDeleting:e.active})},offerCombineChange:function(e){this.$store.commit("setValue",{offerCombine:e.active}),this.updatePreviewInVkOffer()},extendedGoodsChange:function(e){this.$store.commit("setValue",{extendedGoods:e.active}),this.updatePreviewInVkOffer()}},template:'\n                    <div class="vkapi-market-export-template-edit">                                \n                        \n                        <div class="vkapi-market-export-template-edit__options"> \n                            <div class="vkapi-market-export-template-edit__switches">                        \n                                <div class="vkapi-market-admin-field">\n                                   <vkapi-market-admin-switch \n                                   name="EXTENDED_GOODS"                           \n                                   :active="extendedGoods" \n                                   @onChange="extendedGoodsChange">\n                                    {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_EXTENDED_GOODS}}\n                                   </vkapi-market-admin-switch>\n                                </div>\n                                                             \n                                 <div class="vkapi-market-admin-field" v-if="offerIblockId">\n                                   <vkapi-market-admin-switch \n                                   name="OFFER_COMBINE"                           \n                                   :active="offerCombine" \n                                   @onChange="offerCombineChange">\n                                    {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_COMBINE}}\n                                   </vkapi-market-admin-switch>\n                                </div>                             \n                                    \n                                 <div class="vkapi-market-admin-field">\n                                   <vkapi-market-admin-switch \n                                   name="DESCRIPTION_DELETE[]" \n                                   value="IMG"\n                                   :active="descriptionDelete" \n                                   @onChange="descriptionDeleteChange">\n                                    {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_DESCRIPTION_DELETE_IMG}}\n                                   </vkapi-market-admin-switch>\n                                </div>\n                                                   \n                                 <div class="vkapi-market-admin-field">\n                                   <vkapi-market-admin-switch \n                                   name="DESCRIPTION_DELETE[]" \n                                   value="LINK"\n                                   :active="descriptionDelete" \n                                   @onChange="descriptionDeleteChange">\n                                    {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_DESCRIPTION_DELETE_LINK}}\n                                   </vkapi-market-admin-switch>\n                                </div>\n                                                     \n                                <div class="vkapi-market-admin-field">\n                                   <vkapi-market-admin-switch \n                                   name="DESCRIPTION_DELETE[]" \n                                   value="TABLE"\n                                   :active="descriptionDelete" \n                                   @onChange="descriptionDeleteChange">\n                                    {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_DESCRIPTION_DELETE_TABLE}}\n                                   </vkapi-market-admin-switch>\n                                </div>\n                                                      \n                                <div class="vkapi-market-admin-field">\n                                   <vkapi-market-admin-switch \n                                   name="IMAGE_TO_SQUARE" \n                                   :active="imageToSquare" \n                                   @onChange="imageToSquareChange">\n                                    {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_IMAGE_TO_SQUARE}}\n                                   </vkapi-market-admin-switch>\n                                </div>\n                                                   \n                                <div class="vkapi-market-admin-field">\n                                   <vkapi-market-admin-switch \n                                   name="DISABLED_OLD_ALBUM_DELETING" \n                                   :active="disabledOldAlbumDeleting" \n                                   @onChange="disabledOldAlbumDeletingChange">\n                                    {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_DISABLED_OLD_ALBUM_DELETING}}\n                                   </vkapi-market-admin-switch>\n                                </div>\n                               \n                                <div class="vkapi-market-admin-field">\n                                   <vkapi-market-admin-switch \n                                   name="DISABLED_OLD_ITEM_DELETING" \n                                   :active="disabledOldItemDeleting" \n                                   @onChange="disabledOldItemDeletingChange">\n                                    {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_DISABLED_OLD_ITEM_DELETING}}\n                                   </vkapi-market-admin-switch>\n                                </div>                                   \n                            </div>   \n                            <div class="vkapi-market-export-template-edit__props">\n                                <vkapi-market-export-properties :selected="properties" v-show="extendedGoods"/>\n                            </div>\n                        </div>  \n                                    \n                        <div class="vkapi-market-export-template-edit__product">\n                            <div class="vkapi-market-export-template-edit__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRODUCT_TEMPLATE}}</div>\n                            <div class="vkapi-market-export-template-edit__columns">\n                                <div class="vkapi-market-export-template-edit__column">\n                                   \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE}}<span class="vkapi-market-admin-field__req" /></div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_PRICE" v-model="productPrice" class="vkapi-market-admin-select" >\n                                                <optgroup v-for="group in getProductPriceList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>                                    \n                                            </select>\n                                        </div>\n                                    </div> \n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">\n                                        {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE_GROUPS}}<span class="vkapi-market-admin-field__req" />\n                                        <br>\n                                        <small>{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE_GROUPS_HELP}}</small>\n                                        </div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_PRICE_GROUPS[]" v-model="productPriceGroups" class="vkapi-market-admin-select" multiple size="5" >\n                                                <option v-for="option in userGroupList" :key="option.id" :value="option.id">{{option.name}}</option>                                                                                      \n                                            </select>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="vkapi-market-admin-field" v-if="getProductPriceOldList.length">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE_OLD}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_PRICE_OLD" v-model="productPriceOld" class="vkapi-market-admin-select" >\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getProductPriceOldList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>                                    \n                                            </select>\n                                        </div>\n                                    </div>  \n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NAME}}<span class="vkapi-market-admin-field__req" /></div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_NAME" v-model="productName" class="vkapi-market-admin-select" >\n                                                <optgroup v-for="group in getProductNameList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                      <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PICTURE}}<span class="vkapi-market-admin-field__req" /></div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_PICTURE" v-model="productPicture" class="vkapi-market-admin-select" >\n                                                <optgroup v-for="group in getProductPictureList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div> \n                                    \n                                    <div class="vkapi-market-admin-field" >\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PICTURE_MORE}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_PICTURE_MORE" v-model="productPictureMore"  class="vkapi-market-admin-select">\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getProductPictureList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>  \n                                    \n                                    <div class="vkapi-market-admin-field" >\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_SKU}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_SKU" v-model="productSku"  class="vkapi-market-admin-select">\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getProductSkuList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>  \n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_WEIGHT}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_WEIGHT" v-model="productWeight" class="vkapi-market-admin-select" >\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getProductWeightList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                     <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_LENGTH}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_LENGTH" v-model="productLength" class="vkapi-market-admin-select" >\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getProductLengthList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_HEIGHT}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_HEIGHT" v-model="productHeight" class="vkapi-market-admin-select" >\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getProductHeightList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_WIDTH}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_WIDTH" v-model="productWidth" class="vkapi-market-admin-select" >\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getProductWidthList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_QUANTITY}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="PRODUCT_QUANTITY" v-model="productQuantity" class="vkapi-market-admin-select" >\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getProductQuantityList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                    \n                                  \n                                </div>\n                                <div class="vkapi-market-export-template-edit__column">\n                                                                \n                                </div>\n                            </div>\n                            \n                            <div class="vkapi-market-export-template-edit__content">\n                                <vkapi-market-export-template />\n                            </div>           \n                        </div>\n                        \n                        <div class="vkapi-market-export-template-edit__offer" v-if="offerIblockId">\n                            <div class="vkapi-market-export-template-edit__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_OFFER_TEMPLATE}}</div>\n                             <div class="vkapi-market-export-template-edit__columns">\n                                <div class="vkapi-market-export-template-edit__column">\n                                \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE}}<span class="vkapi-market-admin-field__req" /></div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_PRICE" v-model="offerPrice" class="vkapi-market-admin-select" >\n                                                <optgroup v-for="group in getOfferPriceList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>                                    \n                                            </select>\n                                        </div>\n                                    </div>  \n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">\n                                        {{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE_GROUPS}}<span class="vkapi-market-admin-field__req" />\n                                        <br>\n                                        <small>{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE_GROUPS_HELP}}</small>\n                                        </div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_PRICE_GROUPS[]" v-model="offerPriceGroups" class="vkapi-market-admin-select" multiple size="5">                                              \n                                                <option v-for="option in userGroupList" :key="option.id" :value="option.id">{{option.name}}</option>  \n                                            </select>\n                                        </div>\n                                    </div>  \n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PRICE_OLD}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_PRICE_OLD" v-model="offerPriceOld" class="vkapi-market-admin-select" >\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getOfferPriceOldList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>                                    \n                                            </select>\n                                        </div>\n                                    </div>  \n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NAME}}<span class="vkapi-market-admin-field__req" /></div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_NAME" v-model="offerName" class="vkapi-market-admin-select" >\n                                                <optgroup v-for="group in getOfferNameList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>  \n                                    \n                                     <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PICTURE}}<span class="vkapi-market-admin-field__req" /></div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_PICTURE" v-model="offerPicture" class="vkapi-market-admin-select" >\n                                                <optgroup v-for="group in getOfferPictureList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div> \n                                    \n                                    <div class="vkapi-market-admin-field" >\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_PICTURE_MORE}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_PICTURE_MORE" v-model="offerPictureMore"  class="vkapi-market-admin-select">\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getOfferPictureList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>  \n                                    \n                                    <div class="vkapi-market-admin-field" >\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_SKU}}</div>\n                                            <div class="vkapi-market-admin-field__value">\n                                                <select name="OFFER_SKU" v-model="offerSku"  class="vkapi-market-admin-select">\n                                                 <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                    <optgroup v-for="group in getOfferSkuList" :label="group.name">\n                                                        <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                    </optgroup>   \n                                                </select>\n                                            </div>\n                                        </div>                            \n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_WEIGHT}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_WEIGHT" v-model="offerWeight" class="vkapi-market-admin-select" >\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getOfferWeightList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_LENGTH}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_LENGTH" v-model="offerLength" class="vkapi-market-admin-select" >\n                                                <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                               \n                                                <optgroup v-for="group in getOfferLengthList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_HEIGHT}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_HEIGHT" v-model="offerHeight" class="vkapi-market-admin-select" >\n                                                <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                               \n                                                <optgroup v-for="group in getOfferHeightList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_WIDTH}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_WIDTH" v-model="offerWidth" class="vkapi-market-admin-select" >\n                                                <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                \n                                                <optgroup v-for="group in getOfferWidthList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="vkapi-market-admin-field">\n                                        <div class="vkapi-market-admin-field__title">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_QUANTITY}}</div>\n                                        <div class="vkapi-market-admin-field__value">\n                                            <select name="OFFER_QUANTITY" v-model="offerQuantity" class="vkapi-market-admin-select" >\n                                             <option  key="-1" value="">{{localize.VKAPI_MARKET_EXPORT_TEMPLATE_EDIT_NOT_SELECTED}}</option>      \n                                                <optgroup v-for="group in getOfferQuantityList" :label="group.name">\n                                                    <option v-for="option in group.items" :key="option.id" :value="option.id">{{option.name}}</option>                                        \n                                                </optgroup>   \n                                            </select>\n                                        </div>\n                                    </div>\n                                                                \n                                   \n                                        \n                                </div>                                                                \n                            </div>\n                            \n                            <div class="vkapi-market-export-template-edit__content">\n                                <vkapi-market-export-template :is-offer-mode="true" ></vkapi-market-export-template>\n                            </div>          \n                            \n                        </div>                                  \n                                                      \n                    </div>'}),this.templateEngine.$mount("#"+this.containerId),new Promise((function(e,t){return e()}))}},{key:"destroyTemplate",value:function(){return this.templateEngine&&(this.templateEngine.$destroy(),this.templateEngine=null),!0}}]),e}();function de(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}i(50),i(8713);var ue=function(){function e(t){n()(this,e),window.VKapiMarketPopupState||(window.VKapiMarketPopupState={counter:1,visible:0}),this.params=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?de(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):de(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({onShow:function(){},onBeforeClose:function(){},onClose:function(){},index:window.VKapiMarketPopupState.counter++,isVisible:!1,contentType:"html",contentUrl:!1,width:"10px",height:"10px"},t),this.box=!1}return a()(e,[{key:"setParam",value:function(e,t){return this.params[e]=t}},{key:"debounce",value:function(e,t){var i=arguments,r=this,n=null;return function(){var o=i;n&&clearTimeout(n),n=setTimeout((function(){e.apply(r,o),n=null}),t)}}},{key:"show",value:function(){var e=this;if(e.params.isVisible)return!1;e.params.isVisible=!0,e.init(),e.resize(),window.VKapiMarketPopupState.visible++,$("html").scrollLeft(0),$("body").css("overflow","hidden"),this.box.fadeIn((function(){e.hidePreloader(),e.params.onShow()}))}},{key:"close",value:function(){var e=this;if(!this.params.isVisible)return!1;this.params.isVisible=!0,this.box.fadeOut((function(){e.params.onBeforeClose(),window.VKapiMarketPopupState.visible--,window.VKapiMarketPopupState.visible<=0&&$("body").css("overflow","auto"),e.params.onClose()}))}},{key:"hidePreloader",value:function(){this.box.find(".vkapi-market-popup--preloader").removeClass("vkapi-market-popup--preloader")}},{key:"init",value:function(){var e=this;this.box||($("body").append('<div class="vkapi-market-popup" id="vkapi-market-popup-'.concat(this.params.index,'">\n                        <div class="vkapi-market-popup__close"></div>\n                        <div class="vkapi-market-popup__content vkapi-market-popup__content--preloader vkapi-market-popup__content--').concat(this.params.contentType,'" ></div>\n                </div>')),this.box=$("#vkapi-market-popup-"+this.params.index),this.content=this.box.find(".vkapi-market-popup__content"),this.params.contentType&&this.content.html('<iframe src="'+this.params.contentUrl+'"  frameborder="0" allowfullscreen></iframe>'),this.content.css({width:this.params.width,height:this.params.height}),this.content.removeClass("vkapi-market-popup__content--preloader"),$(window).resize(e.debounce(e.resize,200)),this.box.on("click",(function(t){t.stopPropagation(),t.preventDefault(),$(this).hasClass("vkapi-market-popup")&&e.close()})),this.box.find(".vkapi-market-popup__close").on((function(t){t.stopPropagation(),t.preventDefault(),e.close()})),this.box.find(".vkapi-market-popup__content").on((function(e){e.stopPropagation(),e.preventDefault()})))}},{key:"resize",value:function(){this.box.css({height:$(window).height(),top:$(window).scrollTop(),zIndex:9999+10*this.params.index})}},{key:"destroy",value:function(){$("#vkapi-market-popup-"+this.params.index).remove()}}]),e}();function me(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}var ve=function(){function e(t){n()(this,e),this.params=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?me(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):me(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({tableId:"default",reloadUrl:"/bitrix/admin/vkapi.market/iblock_section_search.php",blockedFilter:!1,items:{}},t),this.box=!1,this.filter=!!window[this.params.tableId+"_filter"]&&window[this.params.tableId+"_filter"]}return a()(e,[{key:"setParam",value:function(e,t){return this.params[e]=t}},{key:"deleteFilter",value:function(e){return this.params.blockedFilter||this.filter&&this.filter.OnClear(this.params.tableId,this.params.reloadUrl),!1}},{key:"applyFilter",value:function(){return this.params.blockedFilter||this.filter&&this.filter.OnSet(this.params.tableId,this.params.reloadUrl),!1}},{key:"changeIblock",value:function(e){var t=this.params.reloadUrl,i=0;e&&e.selectedIndex>0&&(i=parseInt(e.value,10),isNaN(i)&&(i=0),i>0&&(this.params.blockedFilter=!0,t+="&IBLOCK_ID="+i+"&find_iblock_id="+i+"&set_filter=y",location.href=t))}},{key:"selectedValue",value:function(e){this.params.items&&this.params.items[e]&&(window.opener.VKapiMarketIblockSectionSearch.triggerEvent(this.params.items[e]),window.close())}}],[{key:"triggerEvent",value:function(e){$(window).trigger("VKapiMarketConditionIblockSectionSelectedValue",e)}}]),e}();function fe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}var he=function(){function e(t){n()(this,e),this.params=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):fe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({tableId:"default",reloadUrl:"/bitrix/admin/vkapi.market/iblock_element_search.php",blockedFilter:!1,items:{}},t),this.box=!1,this.filter=!!window[this.params.tableId+"_filter"]&&window[this.params.tableId+"_filter"]}return a()(e,[{key:"setParam",value:function(e,t){return this.params[e]=t}},{key:"deleteFilter",value:function(e){return this.params.blockedFilter||this.filter&&this.filter.OnClear(this.params.tableId,this.params.reloadUrl),!1}},{key:"applyFilter",value:function(){return this.params.blockedFilter||this.filter&&this.filter.OnSet(this.params.tableId,this.params.reloadUrl),!1}},{key:"changeIblock",value:function(e){var t=this.params.reloadUrl,i=0;e&&e.selectedIndex>0&&(i=parseInt(e.value,10),isNaN(i)&&(i=0),i>0&&(this.params.blockedFilter=!0,t+="&IBLOCK_ID="+i+"&find_iblock_id="+i+"&set_filter=y",location.href=t))}},{key:"selectedValue",value:function(e){this.params.items&&this.params.items[e]&&(window.opener.VKapiMarketIblockElementSearch.triggerEvent(this.params.items[e]),window.close())}}],[{key:"triggerEvent",value:function(e){$(window).trigger("VKapiMarketConditionIblockElementSelectedValue",e)}}]),e}();i.g.VKapiMarketPopup=ue,i.g.VKapiMarketState=l,i.g.VKapiMarketHandExport=g,i.g.VKapiMarketOrderImport=y,i.g.VKapiMarketConditions=v,i.g.VKapiMarketAlbumSelect=k,i.g.VKapiMarketExportIblockEdit=C,i.g.VKapiMarketExportTemplateEdit=pe,i.g.VKapiMarketIblockSectionSearch=ve,i.g.VKapiMarketIblockElementSearch=he}()}();